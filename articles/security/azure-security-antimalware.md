---
title: O Microsoft Antimalware para o Azure | Documentos da Microsoft
description: Este artigo fornece uma visão geral da arquitetura de Antimalware da Microsoft para o Azure, incluindo cenários suportados e configurações para ativar, configurar e implementar a proteção para máquinas virtuais e serviços Cloud do Azure. Abordaremos básicas de configuração, gestão e monitorização funcionalidade acessível por meio do Microsoft Azure gestão de serviço da API, scripts do PowerShell, o portal do Azure e o Visual Studio.
services: security
documentationcenter: na
author: barclayn
manager: barbkess
editor: ''
ms.assetid: 265683c8-30d7-4f2b-b66c-5082a18f7a8b
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/26/2019
ms.author: barclayn
ms.openlocfilehash: a57dd07d0fe52b3dbbf4c3827d3e5d21945e75ee
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 04/23/2019
ms.locfileid: "60611418"
---
# <a name="microsoft-antimalware-for-azure-cloud-services-and-virtual-machines"></a>Microsoft Antimalware for Azure Cloud Services and Virtual Machines

O Microsoft Antimalware para o Azure é uma proteção em tempo real gratuita que ajuda a identificar e remover vírus, spyware e outro software malicioso. Gera alertas quando conhecido software malicioso ou indesejável se tentar instalar-se ou executar em seus sistemas do Azure.

A solução baseia-se a mesma plataforma antimalware que o Microsoft Security Essentials \[MSE\], Microsoft Forefront Endpoint Protection, o Microsoft System Center Endpoint Protection, o Windows Intune e o Windows Defender. Microsoft Antimalware para o Azure é uma solução de agente de único para aplicações e ambientes de inquilino, concebidos para ser executado em segundo plano sem intervenção humana. Proteção pode ser implementada com base nas necessidades das cargas de trabalho de aplicação, com qualquer um dos básico seguras por padrão ou avançada de configuração personalizada, incluindo a monitorização de antimalware.

Quando implementar e ativar o Antimalware da Microsoft para o Azure para as suas aplicações, os principais recursos seguintes estão disponíveis:

* **Proteção em tempo real** -monitora a atividade nos serviços Cloud e nas máquinas virtuais para detetar e bloquear a execução de software maligno.
* **Agendado a análise** -verificações periodicamente para detetar software maligno, incluindo programas ativamente em execução.
* **Remediação de software maligno** - automaticamente age em software maligno detetado, como a eliminação ou os colocar em quarentena ficheiros maliciosos e limpeza de entradas de registro malicioso.
* **Atualizações de assinatura** - automaticamente instala as últimas assinaturas de proteção (definições de vírus) para garantir a proteção está atualizada numa frequência previamente determinada.
* **Atualizações do motor antimalware** – automaticamente atualiza o motor Antimalware da Microsoft.
* **Atualiza a plataforma antimalware** – automaticamente atualiza a plataforma Antimalware da Microsoft.
* **Proteção ativa** – relatórios de metadados de telemetria sobre ameaças detetadas e os recursos suspeitos para o Microsoft Azure para garantir que a resposta rápida para o Panorama de ameaças em constante evolução, bem como ativar a entrega de assinatura de síncrono em tempo real através de o sistema de proteção ativa Microsoft (MAPS).
* **Exemplos da geração de relatórios** - fornece e relatórios de exemplos para o serviço Microsoft Antimalware para ajudar a refinar o serviço e ativar a solução de problemas.
* **Exclusões** – permite que aplicativos e administradores de serviço configurar exclusões de ficheiros, processos e discos.  
* **Recolha de eventos de antimalware** - regista o estado de funcionamento de serviço de antimalware, atividades suspeitas e ações de remediação executadas no registo de eventos de sistema operativo e recolhe-los para a conta de armazenamento do Azure do cliente.

> [!NOTE]
> Antimalware da Microsoft também podem ser implementado com o Centro de segurança do Azure. Leia [instalar o Endpoint Protection no Centro de segurança do Azure](../security-center/security-center-install-endpoint-protection.md) para obter mais informações.

## <a name="architecture"></a>Arquitetura

O Microsoft Antimalware para Azure inclui o cliente de Antimalware da Microsoft e o serviço, modelo de implementação clássica de Antimalware, cmdlets do PowerShell de Antimalware e a extensão de diagnóstico do Azure. Antimalware da Microsoft é suportado no Windows Server 2008 R2, Windows Server 2012 e famílias de sistemas operativos do Windows Server 2012 R2. Não é suportada no sistema operativo Windows Server 2008 e também não é suportado no Linux.

O cliente de Antimalware da Microsoft e o serviço é instalado por predefinição num estado desativado em todas as famílias de sistemas operativos de convidado do Azure suportados na plataforma de serviços Cloud. O cliente de Antimalware da Microsoft e o serviço não está instalado por predefinição na plataforma de máquinas virtuais e está disponível como uma funcionalidade opcional através do portal do Azure e a configuração da máquina de Virtual do Visual Studio em extensões de segurança.

Ao utilizar o App Service do Azure, o serviço subjacente que aloja a aplicação web tem o Microsoft Antimalware habilitada nela. Isto é utilizado para proteger a infraestrutura do App Service do Azure e não é executado no conteúdo de cliente.

> [!NOTE]
> O Windows Defender é o Antimalware incorporado ativado no Windows Server 2016. A Interface do Windows Defender também é ativada por predefinição em algumas Windows Server 2016 SKUS [ver aqui para obter mais informações](https://docs.microsoft.com/windows/threat-protection/windows-defender-antivirus/windows-defender-antivirus-on-windows-server-2016). A extensão de Antimalware de VM do Azure ainda pode ser adicionada a uma VM do Windows Server 2016 do Azure com o Windows Defender, mas neste cenário, a extensão será aplicada qualquer opcional [políticas de configuração](https://gallery.technet.microsoft.com/Antimalware-For-Azure-5ce70efe) a ser utilizado pelo Windows Defender, o extensão não irá implementar quaisquer serviços adicionais antimalware.
> Pode ler mais sobre esta atualização [aqui](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).

### <a name="microsoft-antimalware-workflow"></a>O fluxo de trabalho do Microsoft antimalware

O administrador de serviço do Azure pode ativar o Antimalware para o Azure com uma predefinição ou uma configuração personalizada para as suas máquinas virtuais e serviços em nuvem com as seguintes opções:

* Máquinas virtuais – no portal do Azure, em **extensões de segurança**
* Máquinas de virtuais – com a configuração de máquinas virtuais do Visual Studio no Explorador de servidores
* Máquinas virtuais e serviços em nuvem – usando o Antimalware [modelo de implementação clássica](https://msdn.microsoft.com/library/azure/ee460799.aspx)
* Máquinas virtuais e serviços em nuvem – cmdlets do PowerShell através de Antimalware

O portal do Azure ou cmdlets do PowerShell envie o ficheiro de pacote de extensão de Antimalware para o sistema do Azure numa localização fixa previamente determinada. O agente convidado do Azure (ou o agente de recursos de infraestrutura) inicia a extensão de Antimalware, aplicar as definições de configuração de Antimalware fornecidas como entrada. Este passo ativa o serviço de Antimalware com predefinido ou definições de configuração personalizada. Não se for fornecida nenhuma configuração personalizada, o serviço antimalware está ativado com as predefinições de configuração. Consulte a *configuração do Antimalware* secção a [Antimalware da Microsoft para o Azure – exemplos de código](https://aka.ms/amazsamples "Microsoft Antimalware para serviços Cloud do Azure e exemplos de código de VMs")para obter mais detalhes.

Quando em execução, o cliente de Antimalware da Microsoft transfere as definições de assinatura e de motor de proteção mais recentes a partir da Internet e carrega-os no sistema do Azure. O serviço Microsoft Antimalware escreve eventos relacionados com o serviço no registo de eventos do sistema operacional de sistema na origem de evento "Antimalware da Microsoft". Eventos incluem o estado de funcionamento do cliente de Antimalware, estado de proteção e remediação, definições de configuração novos e antigos, atualizações de mecanismos e definições de assinatura e outras pessoas.

Pode ativar a monitorização de Antimalware para o seu serviço Cloud ou Máquina Virtual para que os eventos de registo de eventos de Antimalware escritos que são produzidos de à sua conta de armazenamento do Azure. O serviço Antimalware utiliza a extensão de diagnóstico do Azure para recolher eventos de Antimalware do sistema do Azure para tabelas na conta de armazenamento do Azure do cliente.

O fluxo de trabalho de implantação, incluindo os passos de configuração e opções de suporte para cenários acima são documentados em [cenários de implementação de Antimalware](#antimalware-deployment-scenarios) seção deste documento.

![Microsoft Antimalware no Azure](./media/azure-security-antimalware/sec-azantimal-fig1.PNG)

> [!NOTE]
> No entanto pode utilizar as APIs do Powershell/e modelos Azure Resource Manager para implementar os conjuntos de dimensionamento de máquinas virtuais com a extensão de antimalware da Microsoft.  Para instalar uma extensão numa máquina Virtual já em execução, pode usar o script de python de exemplo [vmssextn.py](https://github.com/gbowerman/vmsstools). Este script obtém a configuração de extensão existente no conjunto de dimensionamento e adiciona uma extensão à lista de extensões existentes em conjuntos de dimensionamento de VM.
>
>

### <a name="default-and-custom-antimalware-configuration"></a>Padrão e a configuração de Antimalware personalizadas

As predefinições de configuração são aplicadas para ativar o Antimalware para serviços Cloud do Azure ou máquinas virtuais quando não fornece definições de configuração personalizada. As definições de configuração padrão tenham sido previamente otimizadas para a execução no ambiente do Azure. Opcionalmente, pode personalizar estas definições de configuração padrão conforme necessário para a sua aplicação do Azure ou a implementação do serviço e aplicá-las para outros cenários de implementação.

A tabela seguinte resume as definições de configuração disponíveis para o serviço Antimalware. As predefinições de configuração são marcadas sob a coluna intitulada "Padrão", abaixo.

![Tabela 1](./media/azure-security-antimalware/sec-azantimal-tb18.PNG)

## <a name="antimalware-deployment-scenarios"></a>Cenários de implementação de antimalware

Os cenários para ativar e configurar o antimalware, incluindo a monitorização para serviços Cloud do Azure e máquinas virtuais, são abordados nesta seção.

### <a name="virtual-machines---enable-and-configure-antimalware"></a>Máquinas virtuais - ativar e configurar o antimalware

#### <a name="deployment-while-creating-a-vm-using-the-azure-portal"></a>Implementação durante a criação de uma VM com o portal do Azure

Para ativar e configurar o Microsoft Antimalware para máquinas virtuais do Azure no portal do Azure ao aprovisionar uma Máquina Virtual, siga os passos abaixo:

1. Inicie sessão no portal do Azure em <https://portal.azure.com>.
2. Para criar uma nova máquina virtual, navegue para **máquinas virtuais**, selecione **Add**e escolha **Windows Server**.
3. Selecione a versão do Windows server que pretende utilizar.
4. Selecione **Criar**.
    ![Criar máquina virtual](./media/azure-security-antimalware/create-vm.PNG)
5. Fornecer um **Name**, **nome de utilizador**, **palavra-passe**e criar um novo grupo de recursos ou selecione um grupo de recursos existente.
6. Selecione **Ok**.
7. Escolha um tamanho de vm.
8. Na próxima seção, tomar as decisões corretas para suas necessidades, selecione o **extensões** secção.
9. Selecione **Adicionar extensão**
10. Sob **novo recurso**, escolha **Antimalware da Microsoft**.
11. Selecione **Criar**
12. Na **instalar a extensão** secção ficheiro, as localizações e exclusões de processos podem ser configuradas, bem como outras opções de análise. Escolha **Ok**.
13. Escolha **Ok**.
14. De volta a **configurações** secção, escolha **Ok**.
15. Na **Create** ecrã, escolha **Ok**.

#### <a name="deployment-using-the-visual-studio-virtual-machine-configuration"></a>Implementação com a configuração de máquina virtual do Visual Studio

Para ativar e configurar o serviço de Antimalware da Microsoft com o Visual Studio:

1. Ligar ao Microsoft Azure no Visual Studio.

2. Escolha a sua máquina Virtual no **máquinas virtuais** nó **Explorador de servidores**

   ![Configuração da máquina virtual no Visual Studio](./media/azure-security-antimalware/sec-azantimal-fig5.PNG)

3. Com o botão direito **configurar** para ver a página de configuração de Máquina Virtual

4. Selecione **Microsoft Antimalware** extensão na lista pendente em **extensões instaladas** e clique em **Add** para configurar com a configuração predefinida do antimalware.
    ![Extensões instaladas](./media/azure-security-antimalware/sec-azantimal-fig6.PNG)
5. Para personalizar a configuração predefinida do Antimalware, selecione a extensão (realce) o Antimalware da lista de extensões instaladas e clique em **configurar**.

6. Substituir a configuração de Antimalware predefinida com a sua configuração personalizada no formato JSON suportado no **configuração pública** caixa de texto e clique em OK.

7. Clique nas **atualização** botão para enviar por push as atualizações de configuração à máquina Virtual.

    ![Extensão da configuração de máquina virtual](./media/azure-security-antimalware/sec-azantimal-fig7.PNG)

> [!NOTE]
>A configuração de máquinas de virtuais do Visual Studio para Antimalware suporta apenas a configuração do formato para JSON. O modelo de definições de configuração do JSON de Antimalware está incluído nos [Microsoft Antimalware para o Azure - exemplos de código](https://aka.ms/amazsamples "Microsoft Antimalware para o Azure - exemplos de código"), que mostra o suportados Definições de configuração de antimalware.

#### <a name="deployment-using-powershell-cmdlets"></a>Cmdlets de utilizar o PowerShell de implementação

Um serviço ou aplicação do Azure, pode ativar e configurar o Microsoft Antimalware para máquinas virtuais do Azure com cmdlets do PowerShell.

Para ativar e configurar o serviço Microsoft antimalware com cmdlets do PowerShell de antimalware:

1. Configurar o ambiente do PowerShell - consulte a documentação em <https://github.com/Azure/azure-powershell>
2. Utilize o [cmdlet Set-AzureVMMicrosoftAntimalwareExtension Antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azurevmmicrosoftantimalwareextension) para ativar e configurar o Microsoft Antimalware para a Máquina Virtual.

> [!NOTE]
>A configuração de máquinas virtuais do Azure para Antimalware suporta apenas a configuração do formato para JSON. O modelo de definições de configuração do JSON de Antimalware está incluído nos [Microsoft Antimalware para o Azure - exemplos de código](https://aka.ms/amazsamples "Microsoft Antimalware para o Azure - exemplos de código"), que mostra o suportados Definições de configuração de antimalware.

### <a name="enable-and-configure-antimalware-using-powershell-cmdlets"></a>Ativar e configurar o Antimalware através do PowerShell cmdlets

Um serviço ou aplicação do Azure, pode ativar e configurar o Microsoft Antimalware para serviços Cloud do Azure com cmdlets do PowerShell. Tenha em atenção que o Antimalware da Microsoft está instalado num estado desativado na plataforma de serviços Cloud e requer uma ação por uma aplicação do Azure para ativá-la.

Para ativar e configurar o Microsoft Antimalware com cmdlets do PowerShell:

1. Configurar o ambiente do PowerShell - consulte a documentação em <https://github.com/Azure/azure-powershell>
2. Utilize o [cmdlet Set-AzureServiceAntimalwareExtension Antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension) para ativar e configurar o Microsoft Antimalware para o seu serviço Cloud.

O modelo de definições de configuração XML de Antimalware está incluído nos [Microsoft Antimalware para o Azure - exemplos de código](https://aka.ms/amazsamples "Microsoft Antimalware para o Azure - exemplos de código"), que mostra o suportados Definições de configuração de antimalware.

### <a name="cloud-services-and-virtual-machines---configuration-using-powershell-cmdlets"></a>Serviços cloud e máquinas virtuais - cmdlets de configuração através do PowerShell

Uma aplicação do Azure ou serviço pode obter a configuração de Antimalware da Microsoft para serviços Cloud e máquinas virtuais utilizando cmdlets do PowerShell.

Para obter a configuração de Antimalware da Microsoft utilizando cmdlets do PowerShell:

1. Configurar o ambiente do PowerShell - consulte a documentação em <https://github.com/Azure/azure-powershell>
2. **Para máquinas virtuais**: Utilize o [cmdlet Get-AzureVMMicrosoftAntimalwareExtension Antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azurevmmicrosoftantimalwareextension) para obter a configuração de antimalware.
3. **Para os serviços Cloud**: Utilize o [cmdlet Get-AzureServiceAntimalwareConfig Antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azureserviceantimalwareconfig) para obter a configuração de Antimalware.

### <a name="remove-antimalware-configuration-using-powershell-cmdlets"></a>Remover a configuração do Antimalware a utilizar o PowerShell cmdlets

Uma aplicação do Azure ou serviço pode remover a configuração de Antimalware e de qualquer configuração de monitorização de Antimalware associados as relevantes do Azure Antimalware e de diagnóstico extensões de serviço associadas ao serviço Cloud ou Máquina Virtual.

Para remover o Antimalware da Microsoft utilizando cmdlets do PowerShell:

1. Configurar o ambiente do PowerShell - consulte a documentação em <https://github.com/Azure/azure-powershell>
2. **Para máquinas virtuais**: Utilize o [cmdlet Remove-AzureVMMicrosoftAntimalwareExtension Antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/remove-azurevmmicrosoftantimalwareextension).
3. **Para serviços Cloud:** Utilize o [cmdlet Remove-AzureServiceAntimalwareExtension Antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/remove-azureserviceantimalwareextension).

Para **ativar** recolha de eventos de antimalware para uma máquina virtual com o Portal de pré-visualização do Azure:

1. Clique em qualquer parte da lente de monitorização no painel da Máquina Virtual
2. Clique no comando de diagnóstico no painel de métrica
3. Selecione **estado** ON e verifique a opção para o sistema de eventos do Windows
4. . Pode optar por desmarque todas as outras opções na lista, ou deixá-los ativada por suas necessidades de serviço de aplicações.
5. As categorias de eventos de Antimalware "Error", "Aviso", "Informativo", etc., são capturadas na sua conta de armazenamento do Azure.

Eventos de antimalware são recolhidos a partir de registos de sistema de eventos do Windows para a sua conta de armazenamento do Azure. Pode configurar a conta de armazenamento para a Máquina Virtual recolher eventos de Antimalware ao selecionar a conta de armazenamento adequado.

![Métricas e diagnósticos](./media/azure-security-antimalware/sec-azantimal-fig8.PNG)

> [!NOTE]
> Para obter mais informações sobre como log de diagnóstico do Azure Antimalware, leia [ativar o log de diagnóstico do Azure Antimalware](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/).

### <a name="enable-and-configure-antimalware-monitoring-using-powershell-cmdlets"></a>Ativar e configurar a monitorização de antimalware utilizando cmdlets do powerShell

Pode ativar a recolha de eventos de Antimalware da Microsoft para o seu serviço Cloud ou Máquina Virtual com o diagnóstico do Azure através de cmdlets do PowerShell de Antimalware. A extensão de diagnóstico do Azure pode ser configurada para capturar eventos a partir da origem de registo de eventos do sistema "Antimalware da Microsoft" para a sua conta de armazenamento do Azure. As categorias de eventos de Antimalware "Error", "Aviso", "Informativo", etc., são capturadas na sua conta de armazenamento do Azure.

Para ativar a recolha de eventos de Antimalware para a sua conta de armazenamento do Azure com cmdlets do PowerShell:

1. Configurar o ambiente do PowerShell - consulte o <https://github.com/Azure/azure-powershell>
2. **Para máquinas virtuais** -utilize o [cmdlet Set-AzureVMMicrosoftAntimalwareExtension Antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azurevmmicrosoftantimalwareextension) com a opção de monitorização ON.
3. **Para os serviços Cloud** -utilize o [cmdlet Set-AzureServiceAntimalwareExtension Antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension) com a opção de monitorização ON.

Pode ver os eventos não processados de Antimalware, olhando para o *WADWindowsEventLogsTable* tabela na sua conta de armazenamento do Azure que configurou para ativar a monitorização de Antimalware. Isso pode ser útil para validar que recolha de eventos de Antimalware está a funcionar, incluindo a obter informações sobre o estado de funcionamento do serviço Antimalware. Para obter mais informações, incluindo o código de exemplo sobre como extrair os eventos de Antimalware da sua conta de armazenamento, consulte [Microsoft Antimalware para o Azure - exemplos de código](https://aka.ms/amazsamples "Microsoft Antimalware para o Azure - exemplos de código").
