---
title: Microsoft Antimalware para Azure Microsoft Docs
description: Este artigo fornece uma visão arquitetónica do Microsoft Antimalware para o Azure, incluindo cenários e configurações suportadas para permitir, configurar e implementar proteção para Serviços de Nuvem Azure e Máquinas Virtuais. Cobriremos a configuração básica, gestão e funcionalidade de monitorização acessível através da gestão de serviços Do Microsoft Azure, scripts PowerShell, portal Azure e Estúdio Visual.
services: security
documentationcenter: na
author: barclayn
manager: barbkess
editor: ''
ms.assetid: 265683c8-30d7-4f2b-b66c-5082a18f7a8b
ms.service: security
ms.subservice: security-fundamentals
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/26/2019
ms.author: barclayn
ms.openlocfilehash: 2b0a8ff9160f5f311bbe3f74afcd4ff8eddf62f4
ms.sourcegitcommit: 509b39e73b5cbf670c8d231b4af1e6cfafa82e5a
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 03/05/2020
ms.locfileid: "78396583"
---
# <a name="microsoft-antimalware-for-azure-cloud-services-and-virtual-machines"></a>Microsoft Antimalware para Serviços de Nuvem Azure e Máquinas Virtuais

O Microsoft Antimalware para o Azure é uma proteção gratuita em tempo real que ajuda a identificar e remover vírus, spyware e outros softwares maliciosos. Gera alertas quando software malicioso ou indesejado conhecido tenta instalar-se ou funcionar nos seus sistemas Azure.

A solução baseia-se na mesma plataforma antimalware que o Microsoft Security Essentials \[MSE\], Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune e Windows Defender. O Microsoft Antimalware para o Azure é uma solução de agente único para aplicações e ambientes de inquilinos, projetado para funcionar em segundo plano sem intervenção humana. A proteção pode ser implementada com base nas necessidades de cargas de trabalho da aplicação, com configuração personalizada básica de segurança por padrão ou avançada, incluindo monitorização antimalware.

Quando implementa e ativa o Microsoft Antimalware para o Azure para as suas aplicações, estão disponíveis as seguintes funcionalidades centrais:

* **Proteção em tempo real** - monitoriza a atividade nos Serviços cloud e em Máquinas Virtuais para detetar e bloquear a execução de malware.
* **Digitalização programada** - Digitaliza periodicamente para detetar malware, incluindo programas de execução ativa.
* **Reparação** de malware - toma automaticamente medidas sobre malware detetado, tais como apagar ou pôr em quarentena ficheiros maliciosos e limpar entradas de registo maliciosos.
* **Atualizações** de assinaturas - instala automaticamente as últimas assinaturas de proteção (definições de vírus) para garantir que a proteção está atualizada numa frequência pré-determinada.
* **Atualizações do Motor Antimalware** – atualiza automaticamente o motor Antimalware da Microsoft.
* **Atualizações** da Plataforma Antimalware – atualiza automaticamente a plataforma Antimalware da Microsoft.
* **Proteção ativa** - relata metadados de telemetria sobre ameaças detetadas e recursos suspeitos para o Microsoft Azure para garantir uma resposta rápida ao cenário de ameaça em evolução, bem como permitir a entrega de assinaturasincronizada em tempo real através do Microsoft Ative Protection System (MAPS).
* **Amostras relatando** - fornece e reporta amostras para o serviço Antimalware microsoft para ajudar a refinar o serviço e permitir a resolução de problemas.
* **Exclusões** – permite que os administradores de aplicação e de serviço configurem exclusões para ficheiros, processos e unidades.  
* Recolha de **eventos antimalware** - regista a saúde do serviço antimalware, atividades suspeitas e ações de reparação tomadas no registo de eventos do sistema operativo e recolhe-as na conta de Armazenamento Azure do cliente.

> [!NOTE]
> O Microsoft Antimalware também pode ser implementado utilizando o Azure Security Center. Leia Instalar proteção de ponto final no Centro de [Segurança Azure](../../security-center/security-center-install-endpoint-protection.md) para obter mais informações.

## <a name="architecture"></a>Arquitetura

O Microsoft Antimalware para o Azure inclui o Cliente e Serviço Antimalware da Microsoft, o modelo de implementação clássico antimalware, os cmdlets Antimalware PowerShell e a Extensão de Diagnóstico sinuoso. O Microsoft Antimalware é suportado nas famílias do Sistema Operativo Windows Server 2008 R2, Windows Server 2012 e Windows Server 2012 R2. Não é suportado no sistema operativo Windows Server 2008, e também não é suportado no Linux.

O Cliente e Serviço Antimalware da Microsoft é instalado por padrão num estado desativado em todas as famílias de sistemas operativos de hóspedes suportados do Azure na plataforma Cloud Services. O Cliente e Serviço Antimalware da Microsoft não está instalado por padrão na plataforma Virtual Machines e está disponível como uma funcionalidade opcional através do portal Azure e da configuração da Máquina Virtual do Estúdio Visual sob extensões de segurança.

Ao utilizar o Serviço de Aplicações Azure, o serviço subjacente que acolhe a aplicação web tem o Microsoft Antimalware ativado no mesmo. Isto é usado para proteger a infraestrutura do Serviço de Aplicações Azure e não funciona com conteúdo de clientes.

> [!NOTE]
> O Windows Defender é o Antimalware incorporado ativado no Windows Server 2016. A Interface do Windows Defender também está ativada por padrão em alguns SKU do Windows Server 2016 [aqui para mais informações](https://docs.microsoft.com/windows/threat-protection/windows-defender-antivirus/windows-defender-antivirus-on-windows-server-2016). A extensão Antimalware Azure VM ainda pode ser adicionada a um Windows Server 2016 Azure VM com Windows Defender, mas neste cenário a extensão aplicará quaisquer políticas de [configuração](https://gallery.technet.microsoft.com/Antimalware-For-Azure-5ce70efe) opcionais a utilizar pelo Windows Defender, a extensão não irá implementar quaisquer serviços antimalware adicionais.
> Pode ler mais sobre esta atualização [aqui](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).

### <a name="microsoft-antimalware-workflow"></a>Fluxo de trabalho antimalware da Microsoft

O administrador de serviço Azure pode ativar o Antimalware para o Azure com uma configuração padrão ou personalizada para as suas Máquinas Virtuais e Serviços cloud utilizando as seguintes opções:

* Máquinas Virtuais – No portal Azure, sob **extensões** de segurança
* Máquinas Virtuais – Utilizando a configuração de máquinas virtuais do Estúdio Visual no Server Explorer
* Máquinas Virtuais e Serviços de Nuvem – Utilizando o [modelo de implantação clássico](https://msdn.microsoft.com/library/azure/ee460799.aspx) antimalware
* Máquinas virtuais e serviços de nuvem – Utilizando cmdlets Antimalware PowerShell

O portal Azure ou os cmdlets PowerShell empurram o ficheiro de extensão Antimalware para o sistema Azure num local fixo pré-determinado. O Agente Convidado Azure (ou o Agente de Tecidos) lança a Extensão Antimalware, aplicando as definições de configuração Antimalware fornecidas como entrada. Este passo permite o serviço Antimalware com configurações de configuração padrão ou personalizada. Se não for fornecida nenhuma configuração personalizada, o serviço antimalware está ativado com as definições de configuração predefinidas. Consulte a secção de *configuração Antimalware* na [Microsoft Antimalware para O Azure – Amostras](https://aka.ms/amazsamples "Microsoft Antimalware para serviços de nuvem azure e amostras de código vMs") de Código para mais detalhes.

Uma vez em execução, o cliente Antimalware da Microsoft descarrega o mais recente motor de proteção e definições de assinatura da Internet e carrega-as no sistema Azure. O serviço Microsoft Antimalware escreve eventos relacionados com o serviço para o sistema os eventos DO slog sob a fonte do evento "Microsoft Antimalware". Os eventos incluem o estado de saúde do cliente Antimalware, estado de proteção e reparação, configurações de configuração novas e antigas, atualizações do motor e definições de assinatura, entre outros.

Pode permitir que a monitorização antimalware para o seu Serviço de Cloud ou Máquina Virtual tenha os eventos de registo de eventos Antimalware escritos à medida que são produzidos na sua conta de armazenamento Azure. O Serviço Antimalware utiliza a extensão De diagnóstico azure para recolher eventos Antimalware do sistema Azure em tabelas na conta de Armazenamento Azure do cliente.

O fluxo de trabalho de implementação, incluindo etapas de configuração e opções suportadas para os cenários acima referidos, está documentado na secção de cenários de [implementação antimalware](#antimalware-deployment-scenarios) deste documento.

![Microsoft Antimalware no Azure](./media/antimalware/sec-azantimal-fig1.PNG)

> [!NOTE]
> No entanto, pode utilizar modelos powershell/APIs e Azure Resource Manager para implementar conjuntos de escala de máquina virtual com a extensão Anti-Malware da Microsoft.  Para instalar uma extensão numa máquina virtual já em execução, pode utilizar o script de python da amostra [vmssextn.py](https://github.com/gbowerman/vmsstools). Este script obtém a extensão existente no Conjunto de Escala e adiciona uma extensão à lista de extensões existentes nos Conjuntos de Escala VM.
>
>

### <a name="default-and-custom-antimalware-configuration"></a>Configuração antimalware padrão e personalizada

As definições de configuração predefinidas são aplicadas para ativar o Antimalware para serviços de nuvem azure ou máquinas virtuais quando não fornece configurações de configuração personalizadas. As definições de configuração predefinidas foram pré-otimizadas para funcionar no ambiente Azure. Opcionalmente, pode personalizar estas definições de configuração padrão conforme necessário para a sua aplicação Azure ou implementação de serviço e aplicá-las para outros cenários de implementação.

A tabela seguinte resume as definições de configuração disponíveis para o serviço Antimalware. As definições de configuração predefinidas estão marcadas sob a coluna "Padrão" abaixo.

![Tabela 1](./media/antimalware/sec-azantimal-tb18.PNG)

## <a name="antimalware-deployment-scenarios"></a>Cenários de implantação antimalware

Os cenários para ativar e configurar o antimalware, incluindo a monitorização dos Serviços de Nuvem Azure e máquinas virtuais, são discutidos nesta secção.

### <a name="virtual-machines---enable-and-configure-antimalware"></a>Máquinas virtuais - ativar e configurar antimalware

#### <a name="deployment-while-creating-a-vm-using-the-azure-portal"></a>Implantação Ao criar um VM usando o portal Azure

Para ativar e configurar o Microsoft Antimalware para Máquinas Virtuais Azure utilizando o portal Azure enquanto aprovisiona uma Máquina Virtual, siga os passos abaixo:

1. Inicie sessão no portal do Azure em <https://portal.azure.com>.
2. Para criar uma nova máquina virtual, navegue para **máquinas Virtuais,** selecione **Adicionar**, e escolha **o Windows Server**.
3. Selecione a versão do servidor Windows que gostaria de utilizar.
4. Selecione **Criar**.
    ![Criar](./media/antimalware/create-vm.PNG) de máquinas virtuais
5. Forneça um **Nome**, **Nome de Utilizador,** **Palavra-Passe,** e crie um novo grupo de recursos ou escolha um grupo de recursos existente.
6. Selecione **Ok**.
7. Escolha um tamanho VM.
8. Na secção seguinte, faça as opções adequadas para as suas necessidades selecione a secção **Extensões.**
9. Selecione **adicionar extensão**
10. Sob **novo recurso,** escolha **O Antimalware da Microsoft**.
11. Selecione **Criar**
12. No ficheiro de secção de **extensão instalar,** as localizações e exclusões de processos podem ser configuradas, bem como outras opções de digitalização. Escolha **Ok**.
13. Escolha **Ok**.
14. De volta à secção **Definições,** escolha **Ok**.
15. No ecrã **Criar,** escolha **Ok**.

#### <a name="deployment-using-the-visual-studio-virtual-machine-configuration"></a>Implementação utilizando a configuração da máquina virtual do Estúdio Visual

Para ativar e configurar o serviço Antimalware da Microsoft utilizando o Visual Studio:

1. Ligue-se ao Microsoft Azure no Estúdio Visual.

2. Escolha a sua Máquina Virtual no nó de **Máquinas Virtuais** no **Server Explorer**

   ![Configuração da Máquina Virtual em Estúdio Visual](./media/antimalware/sec-azantimal-fig5.PNG)

3. **Configurar** o clique direito para visualizar a página de configuração da Máquina Virtual

4. Selecione a extensão **Antimalware** da Microsoft da lista de abandono em **extensões instaladas** e clique em **Adicionar** para configurar com configuração antimalware predefinida.
    ![extensões instaladas](./media/antimalware/sec-azantimal-fig6.PNG)
5. Para personalizar a configuração antimalware predefinida, selecione (realce) a extensão Antimalware na lista de extensões instaladas e clique em **Configurar**.

6. Substitua a configuração antimalware predefinida pela configuração personalizada no formato JSON suportado na caixa de texto de **configuração pública** e clique em OK.

7. Clique no botão **'Actualizar'** para premir as atualizações de configuração para a sua Máquina Virtual.

    ![Extensão de configuração da máquina virtual](./media/antimalware/sec-azantimal-fig7.PNG)

> [!NOTE]
>A configuração visual do Estúdio Virtual Machines para Antimalware suporta apenas a configuração do formato JSON. O modelo de configuração de Configuração Antimalware JSON está incluído no [Microsoft Antimalware For Azure - Code Samples,](https://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples")mostrando as definições de configuração antimalware suportadas.

#### <a name="deployment-using-powershell-cmdlets"></a>Implementação usando cmdlets PowerShell

Uma aplicação ou serviço Azure pode ativar e configurar o Microsoft Antimalware para Máquinas Virtuais Azure utilizando cmdlets PowerShell.

Para ativar e configurar o antimalware da Microsoft utilizando cmdlets antimalware PowerShell:

1. Configurar o seu ambiente PowerShell - Consulte a documentação em <https://github.com/Azure/azure-powershell>
2. Utilize o [cmdlet antimalware de extensão de extensão de conjunto-AzureVMMicrosoftAntimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azurevmmicrosoftantimalwareextension) para ativar e configurar o Antimalware da Microsoft para a sua Máquina Virtual.

> [!NOTE]
>A configuração das Máquinas Virtuais Azure para Antimalware suporta apenas a configuração do formato JSON. O modelo de configuração de Configuração Antimalware JSON está incluído no [Microsoft Antimalware For Azure - Code Samples,](https://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples")mostrando as definições de configuração antimalware suportadas.

### <a name="enable-and-configure-antimalware-using-powershell-cmdlets"></a>Ativar e configurar antimalware utilizando cmdlets PowerShell

Uma aplicação ou serviço Azure pode ativar e configurar o Microsoft Antimalware para os Serviços De Nuvem Azure utilizando cmdlets PowerShell. Note que o Microsoft Antimalware está instalado num estado desativado na plataforma Cloud Services e requer uma ação por uma aplicação Azure para o permitir.

Para ativar e configurar o Microsoft Antimalware utilizando cmdlets PowerShell:

1. Configurar o seu ambiente PowerShell - Consulte a documentação em <https://github.com/Azure/azure-powershell>
2. Utilize o [cmdlet antimalware de extensão de set-AzureServiceAntimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension) para ativar e configurar o Microsoft Antimalware para o seu Serviço cloud.

O modelo de configuração Antimalware XML está incluído no [Microsoft Antimalware For Azure - Code Samples,](https://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples")mostrando as definições de configuração antimalware suportadas.

### <a name="cloud-services-and-virtual-machines---configuration-using-powershell-cmdlets"></a>Serviços de nuvem e máquinas virtuais - Configuração usando cmdlets PowerShell

Uma aplicação ou serviço Azure pode recuperar a configuração Antimalware da Microsoft para Serviços de Cloud e Máquinas Virtuais utilizando cmdlets PowerShell.

Para recuperar a configuração Antimalware da Microsoft utilizando cmdlets PowerShell:

1. Configurar o seu ambiente PowerShell - Consulte a documentação em <https://github.com/Azure/azure-powershell>
2. **Para máquinas virtuais**: Utilize o [cmdlet Antimalware Antimalware De extensão Get-AzureVMMicrosoftAntimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azurevmmicrosoftantimalwareextension) para obter a configuração antimalware.
3. **Para serviços**de nuvem : Utilize o [cmdlet Antimalware Antimalware Get-AzureServiceAntimalwarePara](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azureserviceantimalwareconfig) obter a configuração Antimalware.

### <a name="remove-antimalware-configuration-using-powershell-cmdlets"></a>Remover configuração antimalware utilizando cmdlets PowerShell

Uma aplicação ou serviço Azure pode remover a configuração Antimalware e qualquer configuração de monitorização antimalware associada das extensões de serviço de Antimalware e diagnóstico sitas relevantes associadas ao Serviço cloud ou à Máquina Virtual.

Para remover o Microsoft Antimalware utilizando cmdlets PowerShell:

1. Configurar o seu ambiente PowerShell - Consulte a documentação em <https://github.com/Azure/azure-powershell>
2. **Para máquinas virtuais**: Utilize o [cmdlet Antimalware Antimalware De extensão remove-AzureVMMicrosoftAntimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/remove-azurevmmicrosoftantimalwareextension).
3. **Para serviços na nuvem:** Utilize o [cmdlet antimalware De extensão remove-AzureServiceAntimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/remove-azureserviceantimalwareextension).

Para **permitir a** recolha de eventos antimalware para uma máquina virtual utilizando o Portal de Pré-visualização Azure:

1. Clique em qualquer parte da lente de monitorização na lâmina da máquina virtual
2. Clique no comando de diagnóstico na lâmina métrica
3. Selecione **Status** ON e verifique a opção para o sistema de eventos Windows
4. . Pode optar por desverificar todas as outras opções da lista ou deixá-las ativadas de acordo com as necessidades do serviço de aplicação.
5. As categorias de eventos Antimalware "Error", "Warning", "Informational", etc., são capturadas na sua conta de Armazenamento Azure.

Os eventos antimalware são recolhidos dos registos do sistema de eventos Windows para a sua conta de Armazenamento Azure. Pode configurar a Conta de Armazenamento da sua Máquina Virtual para recolher eventos Antimalware selecionando a conta de armazenamento apropriada.

![Métricas e diagnósticos](./media/antimalware/sec-azantimal-fig8.PNG)

> [!NOTE]
> Para obter mais informações sobre como fazer diagnósticos de login para Antimalware Azure, leia [A Exploração de Diagnósticos Para Antimalware Azure](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/).

### <a name="enable-and-configure-antimalware-monitoring-using-powershell-cmdlets"></a>Ativar e configurar monitorização antimalware utilizando cmdlets powerShell

Pode ativar a recolha de eventos Antimalware Microsoft para o seu Serviço cloud ou máquina virtual utilizando diagnósticos Azure através de cmdlets Antimalware PowerShell. A extensão De diagnóstico do Azure pode ser configurada para capturar eventos desde a fonte de registo de eventos do Sistema "Microsoft Antimalware" para a sua conta de Armazenamento Azure. As categorias de eventos Antimalware "Error", "Warning", "Informational", etc., são capturadas na sua conta de Armazenamento Azure.

Para permitir a recolha de eventos Antimalware na sua conta de Armazenamento Azure utilizando cmdlets PowerShell:

1. Configurar o seu ambiente PowerShell - Consulte <https://github.com/Azure/azure-powershell>
2. **Para máquinas virtuais** - Utilize o [cmdlet Antimalware Antimalware De Extensão Antimalware Set-AzureVMMicrosoftAntimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azurevmmicrosoftantimalwareextension) com a opção Monitoring ON.
3. **Para serviços** em nuvem - Utilize o [cmdlet antimalware de extensão de conjunto-AzureServiceAntimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension) com a opção Monitoring ON.

Pode visualizar os eventos crus Antimalware olhando para a tabela *WADWindowsEventLogsTable* na sua conta de Armazenamento Azure que configurapara permitir a monitorização antimalware. Isto pode ser útil para validar que a coleção de eventos Antimalware está funcionando, incluindo obter informações sobre a saúde do serviço Antimalware. Para obter mais informações, incluindo o código de amostra sobre como extrair eventos Antimalware da sua conta de armazenamento, consulte [o Microsoft Antimalware For Azure - Code Samples](https://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples").
