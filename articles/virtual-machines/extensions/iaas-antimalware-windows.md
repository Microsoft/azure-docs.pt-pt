---
title: Extensão de Antimalware da Microsoft para as VMs do Windows no Azure | Microsoft Docs
description: Implemente a extensão de Antimalware do Azure na máquina virtual do Windows com uma extensão.
services: virtual-machines-windows
documentationcenter: ''
author: TomShinder
manager: jeconnoc
editor: ''
ms.assetid: ''
ms.service: virtual-machines-windows
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: infrastructure-services
ms.date: 04/12/2018
ms.author: tomsh
ms.openlocfilehash: 838e8f2128e446a0c1bfb2ea03fd4f9203e6100e
ms.sourcegitcommit: d98d99567d0383bb8d7cbe2d767ec15ebf2daeb2
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 05/10/2018
ms.locfileid: "33942810"
---
# <a name="microsoft-antimalware-extension-for-windows"></a>Extensão de Antimalware da Microsoft para Windows

## <a name="overview"></a>Descrição geral

O cenário das ameaças modernas para ambientes de nuvem é extremamente dinâmico, aumentando a pressão de TI empresa subscritores para manter a proteção eficaz para satisfazer os requisitos de conformidade e segurança da nuvem. Antimalware da Microsoft para o Azure é a capacidade de proteção em tempo real livre que ajuda a identificar e remover vírus, spyware, e outro software malicioso, com alertas configuráveis ao conhecido software malicioso ou indesejável tenta instalar-se ou executar nos seus Sistemas do Azure. A solução baseia-se na mesma plataforma antimalware como Essentials de segurança da Microsoft (MSE), o Microsoft Forefront Endpoint Protection, o Microsoft System Center Endpoint Protection, o Windows Intune e o Windows Defender para Windows 8.0 e posterior.
Antimalware da Microsoft para o Azure é uma solução de agente único para aplicações e ambientes de inquilino, concebidos para ser executado em segundo plano, sem qualquer intervenção humana. Pode implementar a proteção com base nas necessidades das cargas de trabalho aplicações, com o básico secure-por-predefinição ou avançadas de configuração personalizada, incluindo a monitorização de antimalware.

## <a name="prerequisites"></a>Pré-requisitos

### <a name="operating-system"></a>Sistema operativo

O Microsoft Antimalware para a solução do Azure inclui o Microsoft Antimalware cliente e o serviço, modelo de implementação clássica Antimalware, os cmdlets do PowerShell de Antimalware e a extensão de diagnóstico do Azure. A solução Antimalware da Microsoft é suportada no Windows Server 2008 R2, Windows Server 2012 e famílias de sistema operativo Windows Server 2012 R2. Não é suportada no sistema operativo Windows Server 2008 e também não é suportado no Linux. 

O Windows Defender é o Antimalware incorporado ativado no Windows Server 2016. A Interface do Windows Defender também está ativada por predefinição do SKU algumas Windows Server 2016.
A extensão de Antimalware de VM do Azure ainda pode ser adicionada a uma VM do Windows Server 2016 do Azure com o Windows Defender, mas neste cenário, que a extensão será aplicada a todas as políticas de configuração opcionais para serem utilizadas pelo Windows Defender, a extensão não irá implementar qualquer serviço de antimalware adicionais. Pode ler mais sobre esta atualização [aqui](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).

### <a name="internet-connectivity"></a>Conectividade Internet

O Microsoft Antimalware para o Windows requer que a máquina virtual de destino está ligada à internet para receber o motor e assinatura atualizações regularmente. 

## <a name="template-deployment"></a>Implementação de modelos
Extensões VM do Azure podem ser implementadas com modelos Azure Resource Manager. Os modelos são ideais quando implementar um ou mais máquinas virtuais que necessitam de configuração de implementação de post, tais como a integração do Azure Antimalware.

A configuração de JSON para uma extensão da máquina virtual pode ser aninhada o recurso de máquina virtual ou colocada no nível superior de um modelo do Resource Manager JSON de raiz ou. A colocação da configuração JSON afeta o valor do nome do recurso e do tipo. Para obter mais informações, consulte [definir nome e tipo para recursos subordinados](../../azure-resource-manager/resource-manager-templates-resources.md). 

O exemplo seguinte assume que a extensão da VM é aninhada o recurso de máquina virtual. Quando o recurso de extensão de aninhamento, JSON é colocado no `"resources": []` objeto da máquina virtual.

```json
{
      "type": "Microsoft.Compute/virtualMachines/extensions",
      "name": "[concat(parameters('vmName'),'/', parameters('vmExtensionName'))]",
      "apiVersion": "2017-03-30",
      "location": "[resourceGroup().location]",
      "dependsOn": [
        "[concat('Microsoft.Compute/virtualMachines/', parameters('vmName'))]"
      ],

      "properties": {
        "publisher": "Microsoft.Azure.Security",
        "type": "IaaSAntimalware",
        "typeHandlerVersion": "1.3",
        "settings": {
          "AntimalwareEnabled": "true",
          "Exclusions": {
            "Extensions": ".log;.ldf",
            "Paths": "D:\\IISlogs;D:\\DatabaseLogs",
            "Processes": "mssence.svc"
          },

          "RealtimeProtectionEnabled": "true",
          "ScheduledScanSettings": {
            "isEnabled": "true",
            "scanType": "Quick",
            "day": "7",
            "time": "120"
          }
        },
        "protectedSettings": null
      }
}
```

## <a name="powershell-deployment"></a>Implementação de PowerShell
Depende do tipo de implementação, utilize o correspondente comandos para implementar a extensão da máquina virtual do Azure Antimalware para uma máquina virtual existente.

  * Máquina Virtual IaaS clássico- http://msdn.microsoft.com/library/azure/dn771718.aspx
  * O Azure Resource Manager baseada em Máquina Virtual https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/
  * Clusters de recursos de infraestrutura de serviço do Azure- https://blogs.msdn.microsoft.com/azuresecurity/2016/10/07/add-microsoft-antimalware-to-azure-service-fabric-clusters/
  * Serviço de nuvem clássico- http://msdn.microsoft.com/library/azure/dn771718.aspx

## <a name="troubleshoot-and-support"></a>Resolver problemas e suporte

### <a name="troubleshoot"></a>Resolução de problemas

Estão disponíveis em - %Systemdrive%\WindowsAzure\Logs\Plugins\Microsoft.Azure.Security.IaaSAntimalware (ou PaaSAntimalware)\1.5.5.x (versão #) \CommandExecution.log registos de extensão de Antimalware da Microsoft

### <a name="error-codes-and-their-meanings"></a>Códigos de erro e os respetivos significados

| Código de erro | Significado | Ação possíveis |
| :---: | --- | --- |
| -2147156224 | MSI está ocupado com outra instalação | Tente executar a instalação anterior será ignorada |
| -2147156221 | Configuração MSE já em execução | Executar apenas uma instância de cada vez |
| -2147156208 | < 200 MB de espaço em disco insuficiente | Elimine os ficheiros e repita a instalação |
| -2147156187 | Última instalação, atualização, atualizar ou desinstalar reinício pedido | Reiniciar o computador e repita a instalação |
| -2147156121 | A configuração tentou remover competitor produto. Mas a desinstalação do produto competitor falhou | Tente remover manualmente o produto competitor, reiniciar e repetir a instalação  |
| -2147156116 | Falha na validação de ficheiro de política | Certifique-se a que transmitir um ficheiro XML de política válido para o programa de configuração  |
| -2147156095 | A configuração não conseguiu iniciar o serviço Antimalware | Certifique-se de que todos os binários estejam corretamente assinados e ficheiro de licenciamento direita é instalado |
| -2147023293 | Ocorreu um erro fatal durante a instalação. Na maioria dos casos, irá. Serviço de register\start\stop AM ou mini EPP.msi, não é possível filtrar controladores | Registos de MSI do EPP.msi são necessários, aqui para investigação futura |
| -2147023277 | Não foi possível abrir o pacote de instalação | Certifique-se de que o pacote existe e está acessível ou contacte o fabricante da aplicação para verificar que se trata de um pacote válido do Windows Installer |
| -2147156109 | Defender é necessário como pré-requisito |  |
| -2147205073 | Não é suportado o emissor de websso | |
| -2147024893 | O sistema não é possível localizar o caminho especificado |  |
| -2146885619 | Não criptográfica ou uma mensagem a mensagem de criptografia não está formatada corretamente |  |
| -1073741819 | As instruções em 0x memória p de % referenciado em 0 x %p. A memória não foi possível %s |  |
| 1 | Função incorreta |  |


### <a name="support"></a>Suporte

Se precisar de mais ajuda, a qualquer altura neste artigo, pode contactar as especialistas do Azure no [fóruns do MSDN Azure e Stack Overflow](https://azure.microsoft.com/support/forums/). Em alternativa, pode ficheiro um incidente de suporte do Azure. Vá para o [site de suporte do Azure](https://azure.microsoft.com/support/options/)e selecione o suporte de Get. Para informações sobre como utilizar o suporte do Azure, leia o [suporte do Microsoft Azure FAQ](https://azure.microsoft.com/support/faq/).