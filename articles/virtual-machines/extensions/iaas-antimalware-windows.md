---
title: Extensão de Antimalware da Microsoft para VMs do Windows no Azure | Documentos da Microsoft
description: Implemente a extensão de Antimalware do Azure na máquina de virtual do Windows com uma extensão.
services: virtual-machines-windows
documentationcenter: ''
author: TomShinder
manager: gwallace
editor: ''
ms.assetid: ''
ms.service: virtual-machines-windows
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: infrastructure-services
ms.date: 04/12/2018
ms.author: tomsh
ms.openlocfilehash: f6599d327bdbba17b7a4d387e9527604a959aa87
ms.sourcegitcommit: c105ccb7cfae6ee87f50f099a1c035623a2e239b
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 07/09/2019
ms.locfileid: "67706698"
---
# <a name="microsoft-antimalware-extension-for-windows"></a>Extensão de Antimalware da Microsoft para Windows

## <a name="overview"></a>Descrição geral

O Panorama de ameaças modernas para ambientes de nuvem é extremamente dinâmico, aumentando a pressão em TI empresa subscritores para manter a proteção em vigor para atender aos requisitos de conformidade e segurança da cloud. Microsoft Antimalware para o Azure é a capacidade de proteção em tempo real gratuito que ajuda a identificar e remover vírus, spyware e outro software malicioso, com alertas configuráveis quando conhecido software malicioso ou indesejável tentarem instalar-se ou executar seu Sistemas do Azure. A solução baseia-se na mesma plataforma antimalware como o Microsoft Security Essentials (MSE), o Microsoft Forefront Endpoint Protection, o Microsoft System Center Endpoint Protection, o Windows Intune e o Windows Defender para Windows 8.0 e superior.
Microsoft Antimalware para o Azure é uma solução de agente de único para aplicações e ambientes de inquilino, concebidos para ser executado em segundo plano sem intervenção humana. Pode implementar proteção com base nas necessidades de suas cargas de trabalho de aplicação, com qualquer um dos básica seguras por padrão ou avançadas de configuração personalizada, incluindo a monitorização de antimalware.

## <a name="prerequisites"></a>Pré-requisitos

### <a name="operating-system"></a>Sistema operativo

O Microsoft Antimalware para a solução do Azure inclui o cliente de Antimalware da Microsoft e o serviço, modelo de implementação clássica de Antimalware, cmdlets do PowerShell de Antimalware e a extensão de diagnóstico do Azure. A solução de Antimalware da Microsoft é suportada no Windows Server 2008 R2, Windows Server 2012 e famílias de sistemas operativos do Windows Server 2012 R2. Não é suportada no sistema operativo Windows Server 2008 e também não é suportado no Linux. 

O Windows Defender é o Antimalware incorporado ativado no Windows Server 2016. A Interface do Windows Defender também está ativada por predefinição do SKU alguns Windows Server 2016.
A extensão de Antimalware de VM do Azure ainda pode ser adicionada a uma VM do Windows Server 2016 do Azure com o Windows Defender, mas neste cenário, que a extensão será aplicada a todas as políticas de configuração opcionais a serem utilizadas pelo Windows Defender, a extensão não irá implementar qualquer serviço de antimalware adicionais. Pode ler mais sobre esta atualização [aqui](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).

### <a name="internet-connectivity"></a>Conectividade Internet

O Microsoft Antimalware para o Windows requer que a máquina virtual de destino está ligada à internet para receber atualizações regulares de assinatura e de motor. 

## <a name="template-deployment"></a>Implementação de modelos
Extensões VM do Azure podem ser implementadas com modelos Azure Resource Manager. Os modelos são ideais quando implementar um ou mais máquinas virtuais que necessitam de configuração pós-implementação, tais como a adesão ao Azure Antimalware.

A configuração do JSON para uma extensão de máquina virtual pode ser aninhada dentro do recurso de máquina virtual ou colocada na raiz ou de nível superior de um modelo do Resource Manager JSON. A colocação da configuração do JSON afeta o valor do tipo e nome do recurso. Para obter mais informações, consulte [defina o nome e tipo para recursos subordinados](../../azure-resource-manager/resource-group-authoring-templates.md#child-resources). 

O exemplo a seguir supõe que a extensão de VM é aninhada dentro do recurso de máquina virtual. Quando aninhar o recurso de extensão, o JSON é colocado no `"resources": []` objeto da máquina virtual.

```json
{
      "type": "Microsoft.Compute/virtualMachines/extensions",
      "name": "[concat(parameters('vmName'),'/', parameters('vmExtensionName'))]",
      "apiVersion": "2017-03-30",
      "location": "[resourceGroup().location]",
      "dependsOn": [
        "[concat('Microsoft.Compute/virtualMachines/', parameters('vmName'))]"
      ],

      "properties": {
        "publisher": "Microsoft.Azure.Security",
        "type": "IaaSAntimalware",
        "typeHandlerVersion": "1.3",
        "settings": {
          "AntimalwareEnabled": "true",
          "Exclusions": {
            "Extensions": ".log;.ldf",
            "Paths": "D:\\IISlogs;D:\\DatabaseLogs",
            "Processes": "mssence.svc"
          },

          "RealtimeProtectionEnabled": "true",
          "ScheduledScanSettings": {
            "isEnabled": "true",
            "scanType": "Quick",
            "day": "7",
            "time": "120"
          }
        },
        "protectedSettings": null
      }
}
```

## <a name="powershell-deployment"></a>Implementação do PowerShell
Depende do tipo de implementação, utilize o correspondente comandos para implementar a extensão de máquina virtual de Antimalware do Azure para uma máquina virtual existente.

  * Máquina Virtual IaaS clássico- https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension
  * O Azure Resource Manager com base em Máquina Virtual- https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/
  * Clusters de recursos de infraestrutura do serviço do Azure- https://blogs.msdn.microsoft.com/azuresecurity/2016/10/07/add-microsoft-antimalware-to-azure-service-fabric-clusters/
  * Serviço Cloud clássico- https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension

## <a name="troubleshoot-and-support"></a>Resolução de problemas e suporte

### <a name="troubleshoot"></a>Resolução de problemas

Microsoft Antimalware extension logs are available at - %Systemdrive%\WindowsAzure\Logs\Plugins\Microsoft.Azure.Security.IaaSAntimalware(Or PaaSAntimalware)\1.5.5.x(version#)\CommandExecution.log

### <a name="error-codes-and-their-meanings"></a>Códigos de erro e seus significados

| Código de erro | Significado | Ação possível |
| :---: | --- | --- |
| -2147156224 | MSI está ocupado com instalação diferente | Tente executar a instalação do último |
| -2147156221 | Configuração do MSE já em execução | Executar apenas uma instância de cada vez |
| -2147156208 | < A 200 MB de espaço em disco insuficiente | Excluir arquivos não utilizados e repetir a instalação |
| -2147156187 | Da última instalação, atualização, atualização ou desinstalação de reinício pedida | Reinicie e repetir a instalação |
| -2147156121 | Configuração tentou remover o produto concorrente. Mas a desinstalação do produto concorrente falhou | Tente remover manualmente o produto concorrente, reiniciar e repetir a instalação  |
| -2147156116 | Falha na validação de ficheiro de política | Certifique-se de que passar um arquivo XML de política válido para a configuração  |
| -2147156095 | A configuração não foi possível iniciar o serviço Antimalware | Certifique-se de que todos os binários são corretamente assinados e ficheiro de licenciamento certo é instalado |
| -2147023293 | Ocorreu um erro fatal durante a instalação. Na maioria dos casos, ele será. Serviço de register\start\stop AM ou mini EPP.msi, não é possível filtrar controladores | Registos do MSI do EPP.msi são necessários aqui para investigação futura |
| -2147023277 | Não foi possível abrir o pacote de instalação | Certifique-se de que o pacote existe e está acessível ou contacte o fornecedor do aplicativo para verificar que se trata de um pacote do Windows Installer válido |
| -2147156109 | Defender é necessário como pré-requisito |  |
| -2147205073 | Não é suportado o emissor de websso | |
| -2147024893 | O sistema não é possível localizar o caminho especificado |  |
| -2146885619 | Não uma mensagem de criptografia ou a mensagem de criptografia não está formatada corretamente |  |
| -1073741819 | A instrução em 0 vezes a memória de p de % referenciado em 0 x %p. A memória não é possível %s |  |
| 1 | Função incorreta |  |


### <a name="support"></a>Suporte

Se precisar de mais ajuda a qualquer momento neste artigo, pode contactar os especialistas do Azure sobre o [fóruns do Azure do MSDN e Stack Overflow](https://azure.microsoft.com/support/forums/). Em alternativa, pode enviar um incidente de suporte do Azure. Vá para o [site de suporte do Azure](https://azure.microsoft.com/support/options/)e selecione o suporte de Get. Para informações sobre como utilizar o suporte do Azure, leia os [FAQ do suporte Microsoft Azure](https://azure.microsoft.com/support/faq/).
