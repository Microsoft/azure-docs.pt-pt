---
title: Extensão antimalware da Microsoft para VMs do Windows no Azure
description: Implemente a extensão Antimalware Azure na máquina virtual do Windows utilizando uma extensão.
services: virtual-machines-windows
documentationcenter: ''
author: TomShinder
manager: gwallace
editor: ''
ms.assetid: ''
ms.service: virtual-machines-windows
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: infrastructure-services
ms.date: 04/12/2018
ms.author: tomsh
ms.openlocfilehash: 4cdde31bb25dc9834ba53539c33c4e49c952840a
ms.sourcegitcommit: 3c925b84b5144f3be0a9cd3256d0886df9fa9dc0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 02/28/2020
ms.locfileid: "77911751"
---
# <a name="microsoft-antimalware-extension-for-windows"></a>Extensão antimalware da Microsoft para Windows

## <a name="overview"></a>Descrição geral

O moderno cenário de ameaça para ambientes em nuvem é extremamente dinâmico, aumentando a pressão sobre os subscritores da nuvem de TI do negócio para manter uma proteção eficaz de forma a satisfazer os requisitos de conformidade e segurança. O Microsoft Antimalware para o Azure é uma capacidade de proteção gratuita em tempo real que ajuda a identificar e remover vírus, spyware e outros softwares maliciosos, com alertas configuráveis quando conhecidos software malicioso ou indesejado tenta instalar-se ou executar no seu Sistemas Azure. A solução baseia-se na mesma plataforma antimalware que o Microsoft Security Essentials (MSE), microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune e Windows Defender para windows 8.0 e superior.
O Microsoft Antimalware para o Azure é uma solução de agente único para aplicações e ambientes de inquilinos, projetado para funcionar em segundo plano sem intervenção humana. Pode implementar proteção com base nas necessidades das cargas de trabalho da sua aplicação, com configuração personalizada básica de segurança por padrão ou avançada, incluindo monitorização antimalware.

## <a name="prerequisites"></a>Pré-requisitos

### <a name="operating-system"></a>Sistema operativo

O Microsoft Antimalware para a solução Azure inclui o Cliente Antimalware da Microsoft, e o Serviço, modelo de implementação clássico Antimalware, cmdlets Antimalware PowerShell e Extensão de Diagnóstico Azure. A solução Antimalware Microsoft é suportada nas famílias do Sistema Operativo Windows Server 2008 R2, Windows Server 2012 e Windows Server 2012 R2. Não é suportado no sistema operativo Windows Server 2008, e também não é suportado no Linux. 

O Windows Defender é o Antimalware incorporado ativado no Windows Server 2016. A Interface Do Windows Defender também está ativada por padrão em alguns SKU's do Windows Server 2016.
A extensão Antimalware Azure VM ainda pode ser adicionada a um Windows Server 2016 Azure VM com Windows Defender, mas neste cenário a extensão aplicará quaisquer políticas de configuração opcionais a utilizar pelo Windows Defender, a extensão não irá implementar nenhuma serviço antimalware adicional. Pode ler mais sobre esta atualização [aqui](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).

### <a name="internet-connectivity"></a>Conectividade Internet

O Microsoft Antimalware para Windows requer que a máquina virtual alvo esteja ligada à internet para receber atualizações regulares do motor e da assinatura. 

## <a name="template-deployment"></a>Implementação de modelos
Extensões VM do Azure podem ser implementadas com modelos Azure Resource Manager. Os modelos são ideais quando se implanta uma ou mais máquinas virtuais que requerem a configuração da implementação de posts, como o embarque no Azure Antimalware.

A configuração do JSON para uma extensão de máquina virtual pode ser aninhada dentro do recurso de máquina virtual ou colocada na raiz ou de nível superior de um modelo do Resource Manager JSON. A colocação da configuração do JSON afeta o valor do tipo e nome do recurso. Para mais informações, consulte o nome e o [tipo de definição para os recursos infantis.](../../azure-resource-manager/templates/child-resource-name-type.md) 

O exemplo a seguir supõe que a extensão de VM é aninhada dentro do recurso de máquina virtual. Ao nidificar o recurso de extensão, o JSON é colocado no `"resources": []` objeto da máquina virtual.

```json
{
      "type": "Microsoft.Compute/virtualMachines/extensions",
      "name": "[concat(parameters('vmName'),'/', parameters('vmExtensionName'))]",
      "apiVersion": "2019-07-01",
      "location": "[resourceGroup().location]",
      "dependsOn": [
        "[concat('Microsoft.Compute/virtualMachines/', parameters('vmName'))]"
      ],

      "properties": {
        "publisher": "Microsoft.Azure.Security",
        "type": "IaaSAntimalware",
        "typeHandlerVersion": "1.3",
        "autoUpgradeMinorVersion": true,
        "settings": {
          "AntimalwareEnabled": "true",
          "Exclusions": {
            "Extensions": ".log;.ldf",
            "Paths": "D:\\IISlogs;D:\\DatabaseLogs",
            "Processes": "mssence.svc"
          },

          "RealtimeProtectionEnabled": "true",
          "ScheduledScanSettings": {
            "isEnabled": "true",
            "scanType": "Quick",
            "day": "7",
            "time": "120"
          }
        },
        "protectedSettings": null
      }
}
```

## <a name="powershell-deployment"></a>Implementação powerShell
Depende do seu tipo de implantação, utilize os comandos correspondentes para implementar a extensão da máquina virtual Azure Antimalware a uma máquina virtual existente.

  * Máquina virtual baseada em Máquina seleções de Recursos Azure https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/
  * Clusters de tecido de serviço Azure - https://blogs.msdn.microsoft.com/azuresecurity/2016/10/07/add-microsoft-antimalware-to-azure-service-fabric-clusters/
  * Serviço De Nuvem Clássica - https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension

## <a name="troubleshoot-and-support"></a>Resolução de problemas e suporte

### <a name="troubleshoot"></a>Resolução de problemas

Os registos de extensão do Microsoft Antimalware estão disponíveis em - %Systemdrive%\WindowsAzure\Logs\Plugins\Microsoft.Azure.Security.IaaSAntimalware(Or PaaSAntimalware)\1.5.5.x (versão#)\CommandExecution.log

### <a name="error-codes-and-their-meanings"></a>Códigos de erro e seus significados

| Código de erro | Significado | Possível ação |
| :---: | --- | --- |
| -2147156224 | MSI está ocupado com instalação diferente | Experimente a instalação de execução última |
| -2147156221 | MSE configuração já em execução | Executar apenas um caso de cada vez |
| -2147156208 | Espaço de disco baixo e 200 MB | Eliminar ficheiros não utilizados e retentar a instalação |
| -2147156187 | Última instalação, atualização, atualização ou desinstalação solicitada | Instalação de reboot e retry |
| -2147156121 | A configuração tentou remover o produto concorrente. Mas o produto concorrente desinstalar falhou | Tente remover manualmente o produto concorrente, reiniciar e voltar a tentar a instalação  |
| -2147156116 | Validação de ficheiros de política falhou | Certifique-se de que passa um ficheiro XML de política válida para configurar  |
| -2147156095 | A configuração não pôde iniciar o serviço Antimalware | Verifique se todos os binários estão corretamente assinados e o ficheiro de licenciamento certo está instalado |
| -2147023293 | Ocorreu um erro fatal durante a instalação. Na maioria dos casos, vai. Epp.msi, não pode registar\start\stop serviço AM ou mini condutor de filtro | Os registos da MSI da EPP.msi são necessários aqui para futura investigação |
| -2147023277 | Pacote de instalação não podia ser aberto | Verifique se a embalagem existe e está acessível, ou contacte o fornecedor de aplicações para verificar se se trata de um pacote de instalação do Windows válido |
| -2147156109 | Defender é exigido como pré-requisito |  |
| -2147205073 | O emitente websso não é suportado | |
| -2147024893 | O sistema não pode encontrar o caminho especificado |  |
| -2146885619 | Não uma mensagem criptográfica ou a mensagem criptográfica não é formatada corretamente |  |
| -1073741819 | A instrução a 0x%p memória referenciada a 0x%p. A memória não podia ser %s |  |
| 1 | Função incorreta |  |


### <a name="support"></a>Suporte

Se precisar de mais ajuda em qualquer ponto deste artigo, pode contactar os especialistas do Azure nos [fóruns MSDN Azure e Stack Overflow](https://azure.microsoft.com/support/forums/). Em alternativa, pode enviar um incidente de suporte do Azure. Vá ao site de [suporte azure](https://azure.microsoft.com/support/options/)e selecione Obter suporte. Para obter informações sobre a utilização do Suporte Azure, leia o suporte do [Microsoft Azure FAQ](https://azure.microsoft.com/support/faq/).
