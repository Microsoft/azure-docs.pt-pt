---
title: Referência - Linha de base de configuração de convidados Azure Policy para Linux
description: Detalhes da linha de base Linux em Azure implementados através da Configuração de Convidados Azure Policy.
ms.date: 03/12/2021
ms.topic: reference
ms.custom: generated
ms.openlocfilehash: 6b1d3048fdc0945e1ee64e211d2f7b1f9de5e6e6
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 03/30/2021
ms.locfileid: "103419869"
---
# <a name="azure-policy-guest-configuration-baseline-for-linux"></a>Linha de base de configuração de convidados de política Azure para Linux

O artigo que se segue detalha quais as **\[ \] máquinas Preview Linux que devem satisfazer os requisitos para as auditorias de** definição de política de configuração de hóspedes de base de segurança Azure. Para obter mais informações, consulte a configuração do convidado de [política Azure](../concepts/guest-configuration.md) e [a visão geral do Benchmark de Segurança Azure (V2)](../../../security/benchmarks/overview.md).

## <a name="general-security-controls"></a>Controlos gerais de segurança

|Name<br /><sub>(ID)</sub> |Detalhes |Verificação de remediação |
|---|---|---|
|Certifique-se de que a opção nodev é definida em /home partition.<br /><sub>(1.1.4)</sub> |Descrição: Um intruso pode montar um dispositivo especial (por exemplo, bloquear ou dispositivo de carácter) na partição /casa. |Editar o ficheiro /etc/fstab e nodev o quarto campo (opções de montagem) para a partição /casa. Para mais informações, consulte as páginas manuais do fstab(5). |
|Certifique-se de que a opção nodev é definida na partição /tmp.<br /><sub>(1.1.5)</sub> |Descrição: Um intruso pode montar um dispositivo especial (por exemplo, bloquear ou dispositivo de carácter) na partição /tmp. |Editar o ficheiro /etc/fstab e nodev o quarto campo (opções de montagem) para a partição /tmp. Para mais informações, consulte as páginas manuais do fstab(5). |
|Certifique-se de que a opção nodev é definida na partição /var/tmp.<br /><sub>(1.1.6)</sub> |Descrição: Um intruso pode montar um dispositivo especial (por exemplo, dispositivo de bloco ou de caracteres) na partição /var/tmp. |Editar o ficheiro /etc/fstab e nodev o quarto campo (opções de montagem) para a partição /var/tmp. Para mais informações, consulte as páginas manuais do fstab(5). |
|Certifique-se de que a opção nosuida é definida na partição /tmp.<br /><sub>(1.1.7)</sub> |Descrição: Uma vez que o sistema de ficheiros /tmp se destina apenas ao armazenamento temporário de ficheiros, desegure esta opção para garantir que os utilizadores não podem criar ficheiros setuidos em /var/tmp. |Edite o ficheiro /etc/fstab e não faça o quarto campo (opções de montagem) para a partição /tmp. Para mais informações, consulte as páginas manuais do fstab(5). |
|Certifique-se de que a opção nosuid é definida na partição /var/tmp.<br /><sub>(1.1.8)</sub> |Descrição: Uma vez que o sistema de ficheiros /var/tmp se destina apenas ao armazenamento temporário de ficheiros, desegure esta opção para garantir que os utilizadores não podem criar ficheiros setuid em /var/tmp. |Edite o ficheiro /etc/fstab e não faça o quarto campo (opções de montagem) para a partição /var/tmp. Para mais informações, consulte as páginas manuais do fstab(5). |
|Certifique-se de que a opção noexec é definida na partição /var/tmp.<br /><sub>(1.1.9)</sub> |Descrição: Uma vez que o `/var/tmp` sistema de ficheiros se destina apenas ao armazenamento temporário de ficheiros, desegure esta opção para garantir que os utilizadores não podem executar binários executáveis a partir de `/var/tmp` . |Edite o ficheiro /etc/fstab e adicione noexec ao quarto campo (opções de montagem) para a partição /var/tmp. Para mais informações, consulte as páginas manuais do fstab(5). |
|Certifique-se de que a opção noexec é definida na partição /dev/shm.<br /><sub>(1.1.16)</sub> |Descrição: Definir esta opção num sistema de ficheiros impede os utilizadores de executar programas a partir de memória partilhada. Isto impede os utilizadores de introduzirem software potencialmente malicioso no sistema. |Edite o ficheiro /etc/fstab e adicione noexec ao quarto campo (opções de montagem) para a partição /dev/shm. Para mais informações, consulte as páginas manuais do fstab(5). |
|Desativar a desmontagem automática<br /><sub>(1.1.21)</sub> |Descrição: Com a montagem automática ativada qualquer pessoa com acesso físico poderia anexar uma unidade USB ou disco e ter o seu conteúdo disponível no sistema, mesmo que não tivessem permissões para montá-lo eles mesmos. |Desative o serviço de autofs ou executar '/opt/microsoft/omsagent/plugin/omsremediato -r disable-autofs' |
|Certifique-se de que a montagem de dispositivos de armazenamento USB está desativada<br /><sub>(1.1.21.1)</sub> |Descrição: Remover o suporte para dispositivos de armazenamento USB reduz a superfície de ataque local do servidor. |Editar ou criar um ficheiro no `/etc/modprobe.d/` diretório que termina em .conf e adicione `install usb-storage /bin/true` depois descarregar o módulo de armazenamento usb ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods' |
|Certifique-se de que os depósitos do núcleo são restritos.<br /><sub>(1.5.1)</sub> |Descrição: A definição de um limite rígido nas lixeiras do núcleo impede que os utilizadores sobrepuem a variável suave. Se forem necessárias descargas de núcleo, considere a definição de limites para os grupos de utilizador (ver `limits.conf(5)` ). Além disso, a definição da `fs.suid_dumpable` variável para 0 impedirá que os programas setuids descarreguem o núcleo. |Adicione `hard core 0` a /etc/security/limits.conf ou um ficheiro no diretório limites.d e definido `fs.suid_dumpable = 0` em sysctl ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-core-dumps' |
|Certifique-se de que a pré-ligação está desativada.<br /><sub>(1.5.4)</sub> |Descrição: A função de pré-ligação pode interferir com o funcionamento do AIDE, porque altera binários. O prelinking também pode aumentar a vulnerabilidade do sistema se um utilizador malicioso for capaz de comprometer uma biblioteca comum, como o libc. |desinstalar `prelink` utilizando o seu gestor de pacotes ou executar '/opt/microsoft/omsagent/plugin/omsremediato -r remove-prelink' |
|Certifique-se de que as permissões em /etc/motd estão configuradas.<br /><sub>(1.7.1.4)</sub> |Descrição: Se o `/etc/motd` ficheiro não tiver a propriedade correta, pode ser modificado por utilizadores não autorizados com informações incorretas ou enganosas. |Defina o proprietário e o grupo de /etc/motd para raíz e defina permissões para 0644 ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r file-permissões' |
|Certifique-se de que as permissões em /etc/emissão estão configuradas.<br /><sub>(1.7.1.5)</sub> |Descrição: Se o `/etc/issue` ficheiro não tiver a propriedade correta, pode ser modificado por utilizadores não autorizados com informações incorretas ou enganosas. |Defina o proprietário e o grupo de /etc/emissão para raíz e defina permissões para 0644 ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r file-permissões' |
|Certifique-se de que as permissões em /etc/issue.net estão configuradas.<br /><sub>(1.7.1.6)</sub> |Descrição: Se o `/etc/issue.net` ficheiro não tiver a propriedade correta, pode ser modificado por utilizadores não autorizados com informações incorretas ou enganosas. |Defina o proprietário e grupo de /etc/issue.net para raiz e defina permissões para 0644 ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r file-permissões' |
|A opção nodev deve ser ativada para todos os meios amovíveis.<br /><sub>(2.1)</sub> |Descrição: Um intruso pode montar um dispositivo especial (por exemplo, bloquear ou dispositivo de carácter) através de meios amovíveis |Adicione a opção nodev ao quarto campo (opções de montagem) em /etc/fstab |
|A opção noexec deve ser ativada para todos os meios amovíveis.<br /><sub>(2.2)</sub> |Descrição: Um intruso poderia carregar ficheiro executável através de meios amovíveis |Adicione a opção noexec ao quarto campo (opções de montagem) em /etc/fstab |
|A opção nosuida deve ser ativada para todos os meios amovíveis.<br /><sub>(2.3)</sub> |Descrição: Um intruso pode carregar ficheiros que funcionam com um contexto de segurança elevado através de meios amovíveis |Adicione a opção nosuida ao quarto campo (opções de montagem) em /etc/fstab |
|Certifique-se de que o cliente da conversa não está instalado.<br /><sub>(2.3.3)</sub> |Descrição: O software apresenta um risco de segurança, uma vez que utiliza protocolos não encriptados para comunicação. |Desinstalar `talk`  ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r remove-talk' |
|Certifique-se de que as permissões em /etc/hosts.permitem que estejam configuradas.<br /><sub>(3.4.4)</sub> |Descrição: É fundamental garantir que o `/etc/hosts.allow` ficheiro está protegido contra o acesso não autorizado à escrita. Apesar de estar protegido por defeito, as permissões do ficheiro podem ser alteradas inadvertidamente ou através de ações maliciosas. |Defina o proprietário e o grupo de /etc/hosts.permita a raiz e as permissões para 0644 ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r file-permissões' |
|Certifique-se de que as permissões em /etc/hosts.deny estão configuradas.<br /><sub>(3.4.5)</sub> |Descrição: É fundamental garantir que o `/etc/hosts.deny` ficheiro está protegido contra o acesso não autorizado à escrita. Apesar de estar protegido por defeito, as permissões do ficheiro podem ser alteradas inadvertidamente ou através de ações maliciosas. |Defina o proprietário e o grupo de /etc/hosts.negar a raiz e as permissões para 0644 ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r file-permissões' |
|Garantir a política de falha de negação de firewall<br /><sub>(3.6.2)</sub> |Descrição: Com uma política de aceitação por defeito, a firewall aceitará qualquer pacote que não esteja configurado para ser negado. É mais fácil manter uma firewall segura com uma política DROP predefinido do que com uma política DESEM por defeito. |Desa esta medida de correção da política padrão para o tráfego de entrada, saída e encaminhação para `deny` ou `reject` como apropriado usando o seu software de firewall |
|A opção nodev/nosuid deve ser ativada para todos os suportes NFS.<br /><sub>(5)</sub> |Descrição: Um intruso pode carregar ficheiros que funcionam com um contexto de segurança elevado ou dispositivos especiais através de sistema de ficheiros remotos |Adicione as opções de nosuida e nodev ao quarto campo (opções de montagem) em /etc/fstab |
|Certifique-se de que os requisitos de criação de palavras-passe estão configurados.<br /><sub>(5.3.1)</sub> |Descrição: Palavras-passe fortes protegem os sistemas de serem pirateados através de métodos de força bruta. |Defina os seguintes pares de teclas/valor no PAM apropriado para o seu distro: minlen=14, minclass = 4, dcredit = -1, ucredit = -1, ocredit = -1, lcredit = -1, ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r enable-password-requirements' |
|Certifique-se de que o bloqueio para tentativas de palavra-passe falhadas está configurado.<br /><sub>(5.3.2)</sub> |Descrição: Bloquear iDs do utilizador após `n` tentativas de login consecutivas sem sucesso atenua ataques de senha de força bruta contra os seus sistemas. |para Ubuntu e Debian, adicione os módulos pam_tally e pam_deny conforme apropriado. Para todos os outros distros, consulte a documentação do seu distro |
|Desativar a instalação e utilização de sistemas de ficheiros que não são necessários (cramfs)<br /><sub>(6.1)</sub> |Descrição: Um intruso poderia usar uma vulnerabilidade em cramfs para elevar privilégios |Adicione um ficheiro ao diretório /etc/modprob.d que desativa os cramfs ou execute '/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods' |
|Desative a instalação e utilização de sistemas de ficheiros que não são necessários (freevxfs)<br /><sub>(6.2)</sub> |Descrição: Um intruso poderia usar uma vulnerabilidade em freevxfs para elevar privilégios |Adicione um ficheiro ao diretório /etc/modprob.d que desativa os freevxfs ou execute '/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods' |
|Certifique-se de que todos os diretórios domésticos de todos os utilizadores existem<br /><sub>(6.2.7)</sub> |Descrição: Se o diretório de casa do utilizador não existir ou não estiver atribuído, o utilizador será colocado em '/' e não poderá escrever quaisquer ficheiros ou ter variáveis ambientais locais definidas. |Se os diretórios domésticos de qualquer utilizador não existirem, crie-os e certifique-se de que o respetivo utilizador é dono do diretório. Os utilizadores sem diretório domiciliário atribuído devem ser removidos ou designados um diretório de casa conforme apropriado. |
|Garantir que os utilizadores possuam os seus diretórios domésticos<br /><sub>(6.2.9)</sub> |Descrição: Uma vez que o utilizador é responsável pelos ficheiros armazenados no diretório do utilizador, o utilizador deve ser o proprietário do diretório. |Alterar a propriedade de quaisquer diretórios domésticos que não sejam propriedade do utilizador definido para o utilizador correto. |
|Certifique-se de que os ficheiros de pontos dos utilizadores não são de grupo ou de mundo.<br /><sub>(6.2.10)</sub> |Descrição: Ficheiros de configuração de utilizadores de grupo ou de utilizadores com poderes mundiais podem permitir que utilizadores maliciosos roubem ou modifiquem os dados de outros utilizadores ou obtenham os privilégios do sistema de outro utilizador. |Fazer modificações globais nos ficheiros dos utilizadores sem alertar a comunidade de utilizadores pode resultar em interrupções inesperadas e utilizadores infelizes. Por isso, recomenda-se a criação de uma política de monitorização para reportar permissões de ficheiros de pontos de utilizador e determinar as medidas a tomar de acordo com a política do site. |
|Certifique-se de que nenhum utilizadores tem ficheiros .forward<br /><sub>(6.2.11)</sub> |Descrição: A utilização do `.forward` ficheiro representa um risco de segurança, uma vez que os dados sensíveis podem ser inadvertidamente transferidos para fora da organização. O `.forward` ficheiro também representa um risco, uma vez que pode ser usado para executar comandos que podem executar ações não intencionais. |Fazer modificações globais nos ficheiros dos utilizadores sem alertar a comunidade de utilizadores pode resultar em interrupções inesperadas e utilizadores infelizes. Por conseguinte, recomenda-se a criação de uma política de monitorização para reportar ficheiros de utilizadores `.forward` e determinar as medidas a tomar de acordo com a política do local. |
|Certifique-se de que nenhum utilizadores tem ficheiros .netrc<br /><sub>(6.2.12)</sub> |Descrição: O `.netrc` ficheiro apresenta um risco de segurança significativo uma vez que armazena palavras-passe de forma não encriptada. Mesmo que o FTP seja desativado, as contas dos utilizadores podem ter trazido `.netrc` ficheiros de outros sistemas que podem representar um risco para esses sistemas |Fazer modificações globais nos ficheiros dos utilizadores sem alertar a comunidade de utilizadores pode resultar em interrupções inesperadas e utilizadores infelizes. Por conseguinte, recomenda-se a criação de uma política de monitorização para reportar ficheiros de utilizadores `.netrc` e determinar as medidas a tomar de acordo com a política do local. |
|Certifique-se de que nenhum utilizadores tem ficheiros .rhosts<br /><sub>(6.2.14)</sub> |Descrição: Esta ação só tem significado se `.rhosts` o suporte for permitido no ficheiro `/etc/pam.conf` . Apesar de os `.rhosts` ficheiros serem ineficazes se o suporte for desativado `/etc/pam.conf` , estes podem ter sido trazidos de outros sistemas e podem conter informações úteis a um intruso para esses outros sistemas. |Fazer modificações globais nos ficheiros dos utilizadores sem alertar a comunidade de utilizadores pode resultar em interrupções inesperadas e utilizadores infelizes. Por conseguinte, recomenda-se a criação de uma política de monitorização para reportar ficheiros de utilizadores `.rhosts` e determinar as medidas a tomar de acordo com a política do local. |
|Certifique-se de que todos os grupos em /etc/passwd existem em /etc/grupo<br /><sub>(6.2.15)</sub> |Descrição: Os grupos definidos no ficheiro /etc/passwd mas não no ficheiro /etc/grupo representam uma ameaça para a segurança do sistema, uma vez que as permissões de grupo não são corretamente geridas. |Para cada grupo definido em /etc/passwd, certifique-se de que há um grupo correspondente em /etc/grupo |
|Certifique-se de que não existem UIDs duplicados<br /><sub>(6.2.16)</sub> |Descrição: Os utilizadores devem ser atribuídos UIDs únicos para prestação de contas e para garantir as proteções de acesso adequadas. |Estabeleça UIDs únicos e reveja todos os ficheiros pertencentes aos UIDs partilhados para determinar a que UID devem pertencer. |
|Certifique-se de que não existem GIDs duplicados<br /><sub>(6.2.17)</sub> |Descrição: Os grupos devem ser atribuídos GIDs únicos para prestação de contas e para garantir proteções de acesso adequadas. |Estabeleça GIDs únicos e reveja todos os ficheiros pertencentes aos GIDs partilhados para determinar a que GID devem pertencer. |
|Certifique-se de que não existem nomes de utilizadores duplicados<br /><sub>(6.2.18)</sub> |Descrição: Se um utilizador tiver um nome de utilizador duplicado, criará e terá acesso a ficheiros com o primeiro UID para esse nome de utilizador em `/etc/passwd` . Por exemplo, se o 'test4' tiver um UID de 1000 e uma entrada subsequente de 'test4' tiver um UID de 2000, iniciar sessão como 'test4' utilizará UID 1000. Efetivamente, a UID é partilhada, o que é um problema de segurança. |Estabeleça nomes de utilizador únicos para os utilizadores. As propriedades dos ficheiros refletirão automaticamente a mudança desde que os utilizadores tenham UIDs únicos. |
|Certifique-se de que não existem grupos duplicados<br /><sub>(6.2.19)</sub> |Descrição: Se um grupo tiver um nome de grupo duplicado, criará e terá acesso a ficheiros com o primeiro GID desse grupo em `/etc/group` . Efetivamente, o GID é partilhado, o que é um problema de segurança. |Estabeleça nomes únicos para os grupos de utilizadores. As propriedades do grupo de ficheiros refletirão automaticamente a mudança, desde que os grupos tenham GIDs únicos. |
|Certifique-se de que o grupo sombra está vazio<br /><sub>(6.2.20)</sub> |Descrição: Qualquer utilizadores atribuídos ao grupo sombra teria acesso lido ao ficheiro /etc/sombra. Se os atacantes puderem obter acesso lido ao `/etc/shadow` ficheiro, podem facilmente executar um programa de quebra de palavras-passe contra as palavras-passe hashed para quebrá-las. Outras informações de segurança que sejam armazenadas no `/etc/shadow` ficheiro (como a expiração) também podem ser úteis para subverter contas adicionais de utilizadores. |Remova todos os utilizadores formam o grupo sombra |
|Desative a instalação e utilização de sistemas de ficheiros que não são necessários (hfs)<br /><sub>(6.3)</sub> |Descrição: Um intruso poderia usar uma vulnerabilidade em hfs para elevar privilégios |Adicione um ficheiro ao diretório /etc/modprob.d que desativa os hfs ou execute '/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods' |
|Desative a instalação e utilização de sistemas de ficheiros que não são necessários (hfsplus)<br /><sub>(6.4)</sub> |Descrição: Um intruso poderia usar uma vulnerabilidade no hfsplus para elevar privilégios |Adicione um ficheiro ao diretório /etc/modprob.d que desativa o hfsplus ou execute '/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods' |
|Desative a instalação e utilização de sistemas de ficheiros que não são necessários (jffs2)<br /><sub>(6.5)</sub> |Descrição: Um intruso poderia usar uma vulnerabilidade no jffs2 para elevar privilégios |Adicione um ficheiro ao diretório /etc/modprob.d que desativa jffs2 ou execute '/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods' |
|Os kernels só devem ser compilados a partir de fontes aprovadas.<br /><sub>(10)</sub> |Descrição: Um núcleo de uma fonte não aprovada pode conter vulnerabilidades ou backdoors para garantir o acesso a um intruso. |Instale o núcleo fornecido pelo seu fornecedor distro. |
|/etc/shadow file permissões devem ser definidas para 0400<br /><sub>(11.1)</sub> |Descrição: Um intruso que possa recuperar ou manipular palavras-passe hashed de /etc/sombra se não estiver corretamente protegido. |Defina as permissões e a propriedade de /etc/sombra* ou corra '/opt/microsoft/omsagent/plugin/omsremediato -r set-etc-shadow-perms' |
|/etc/sombra- permissões de ficheiros devem ser definidas para 0400<br /><sub>(11.2)</sub> |Descrição: Um intruso que possa recuperar ou manipular palavras-passe hashed de /etc/sombra, se não estiver corretamente protegido. |Defina as permissões e a propriedade de /etc/sombra* ou corra '/opt/microsoft/omsagent/plugin/omsremediato -r set-etc-shadow-perms' |
|/etc/gshadow permissões de ficheiros devem ser definidas para 0400<br /><sub>(11.3)</sub> |Descrição: Um intruso pode juntar-se a grupos de segurança se este ficheiro não estiver devidamente protegido |Definir as permissões e a propriedade de /etc/gshadow- ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r set-etc-gshadow-perms' |
|/etc/gshadow- permissões de arquivo devem ser definidas para 0400<br /><sub>(11.4)</sub> |Descrição: Um intruso pode juntar-se a grupos de segurança se este ficheiro não estiver devidamente protegido |Definir as permissões e a propriedade de /etc/gshadow ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r set-etc-gshadow-perms' |
|/etc/passwd permissões de ficheiros devem ser 0644<br /><sub>(12.1)</sub> |Descrição: Um intruso pode modificar os usIDs e as conchas de login |Defina as permissões e a propriedade de /etc/passwd ou corra '/opt/microsoft/omsagent/plugin/omsremediato -r set-etc-passwd-perms' |
|/etc/permissões de ficheiros de grupo devem ser 0644<br /><sub>(12.2)</sub> |Descrição: Um intruso pode elevar os privilégios modificando a adesão ao grupo |Defina as permissões e a propriedade de /etc/grupo ou executar '/opt/microsoft/omsagent/plugin/omsremediato -r set-etc-group-perms |
|/etc/passwd- permissões de arquivo devem ser definidas para 0600<br /><sub>(12.3)</sub> |Descrição: Um intruso pode juntar-se a grupos de segurança se este ficheiro não estiver devidamente protegido |Defina as permissões e a propriedade de /etc/passwd- ou executar '/opt/microsoft/omsagent/plugin/omsremediato -r set-etc-passwd-perms |
|/etc/grupo- permissões de arquivo devem ser 0644<br /><sub>(12.4)</sub> |Descrição: Um intruso pode elevar os privilégios modificando a adesão ao grupo |Defina as permissões e a propriedade de /etc/group- ou executar '/opt/microsoft/omsagent/plugin/omsremediato -r set-etc-group-perms |
|O acesso à conta raiz via su deve ser restringido ao grupo 'raiz'<br /><sub>(21)</sub> |Descrição: Um intruso pode aumentar as permissões por palavra-passe, adivinhando se su não for restrito aos utilizadores do grupo raiz. |Executar o comando '/opt/microsoft/omsagent/plugin/omsremediate -r fix-su-permissões'. Isto irá adicionar a linha "auth necessária pam_wheel.so use_uid" ao ficheiro '/etc/pam.d/su' |
|O grupo 'raiz' deve existir, e conter todos os membros que podem su para raiz<br /><sub>(22)</sub> |Descrição: Um intruso pode aumentar as permissões por palavra-passe, adivinhando se su não for restrito aos utilizadores do grupo raiz. |Criar o grupo raiz através do comando 'groupadd -g 0 raiz' |
|Não há contas sem senhas<br /><sub>(23.2)</sub> |Descrição: Um intruso pode iniciar sessão em contas sem senha e executar comandos arbitrários. |Use o comando passwd para definir senhas para todas as contas |
|Contas que não a raiz devem ter UIDs únicos superiores a zero(0)<br /><sub>(24)</sub> |Descrição: Se uma conta que não a raiz tiver zero uid, um intruso pode comprometer a conta e obter privilégios de raiz. |Atribuir uids únicos e não zero a todas as contas não-raiz usando 'usermod -u' |
|A colocação aleatória das regiões de memória virtual deve ser ativada<br /><sub>(25)</sub> |Descrição: Um intruso poderia escrever código executável para regiões conhecidas na memória, resultando na elevação do privilégio |Adicione o valor '1' ou '2' ao ficheiro '/proc/sys/kernel/randomize_va_space' |
|O suporte do Kernel para a função de processador XD/NX deve ser ativado<br /><sub>(26)</sub> |Descrição: Um intruso pode fazer com que um sistema execute um código executável a partir de regiões de dados na memória, resultando na elevação do privilégio. |Confirme que o ficheiro '/proc/cpuinfo' contém a bandeira 'nx' |
|O ''' não deve aparecer na $PATH de Raiz<br /><sub>(27.1)</sub> |Descrição: Um intruso pode elevar os privilégios colocando um ficheiro malicioso no $PATH |Modificar a linha 'EXPORT PATH=' em /root/.profile |
|Os diretórios para casa dos utilizadores devem ser o modo 750 ou mais restritivo<br /><sub>(28)</sub> |Descrição: Um intruso pode obter informações sensíveis das pastas domésticas de outros utilizadores. |Defina permissões de pastas domésticas para 750 ou executar '/opt/microsoft/omsagent/plugin/omsremediato -r fix-home-dir-permissões |
|A umask padrão para todos os utilizadores deve ser definida para 077 em login.defs<br /><sub>(29)</sub> |Descrição: Um intruso pode obter informações sensíveis de ficheiros pertencentes a outros utilizadores. |Executar o comando '/opt/microsoft/omsagent/plugin/omsremediate -r set-default-user-umask'. Isto irá adicionar a linha 'UMASK 077' ao ficheiro '/etc/login.defs' |
|Todos os carregadores de botas devem ter a proteção de senha ativada.<br /><sub>(31)</sub> |Descrição: Um intruso com acesso físico poderia modificar opções de bootloader, dando acesso ilimitado ao sistema |Adicione uma palavra-passe de carregador de arranque ao ficheiro '/boot/grub/grub.cfg' |
|Certifique-se de que as permissões no bootloader config estão configuradas<br /><sub>(31.1)</sub> |Descrição: Definir as permissões para ler e escrever para raiz apenas impede que os utilizadores não-raiz vejam os parâmetros do arranque ou os mudem. Os utilizadores não-raiz que lêem os parâmetros do arranque podem ser capazes de identificar fraquezas na segurança no arranque e ser capazes de explorá-los. |Defina o proprietário e o grupo do seu bootloader para root:root e permissões para 0400 ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r bootloader-permissões |
|Certifique-se de que a autenticação é necessária para o modo de utilizador único.<br /><sub>(33)</sub> |Descrição: Exigir a autenticação em modo único de utilizador impede um utilizador não autorizado de reiniciar o sistema num único utilizador para obter privilégios de raiz sem credenciais. |executar o seguinte comando para definir uma palavra-passe para o utilizador raiz: `passwd root` |
|Certifique-se de que o envio de redirecionamento de pacotes está desativado.<br /><sub>(38.3)</sub> |Descrição: Um intruso poderia utilizar um hospedeiro comprometido para enviar redirecionamentos ICMP inválidos para outros dispositivos router numa tentativa de corromper o encaminhamento e fazer com que os utilizadores acedam a um sistema criado pelo intruso em oposição a um sistema válido. |definir os seguintes parâmetros em /etc/sysctl.conf: 'net.ipv4.conf.all.send_redirects = 0' e 'net.ipv4.conf.default.send_redirects = 0' ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r desactivar-redirecionamentos |
|O envio de redirecionamentos ICMP deve ser desativado para todas as interfaces. (net.ipv4.conf.default.accept_redirects = 0)<br /><sub>(38.4)</sub> |Descrição: Um intruso pode alterar a tabela de encaminhamento deste sistema, redirecionando o tráfego para um destino alternativo |Executar `sysctl -w key=value` e definir para um valor compatível ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-accept-redirects'. |
|O envio de redirecionamentos ICMP deve ser desativado para todas as interfaces. (net.ipv4.conf.default.secure_redirects = 0)<br /><sub>(38.5)</sub> |Descrição: Um intruso pode alterar a tabela de encaminhamento deste sistema, redirecionando o tráfego para um destino alternativo |Executar `sysctl -w key=value` e definir para um valor compatível ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r desativar-secure-redirects' |
|Aceitar pacotes de origem encaminhados deve ser desativado para todas as interfaces. (net.ipv4.conf.all.accept_source_route = 0)<br /><sub>(40.1)</sub> |Descrição: Um intruso pode redirecionar o tráfego para fins maliciosos. |Executar `sysctl -w key=value` e definir para um valor compatível ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-accept-source-route' |
|Aceitar pacotes de origem encaminhados deve ser desativado para todas as interfaces. (net.ipv6.conf.all.accept_source_route = 0) ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-accept-source-route'<br /><sub>(40.2)</sub> |Descrição: Um intruso pode redirecionar o tráfego para fins maliciosos. |Corra `sysctl -w key=value` e desacompense o valor compatível. |
|Deve ser ativada a ignorância das respostas falsas do ICMP às emissões. (net.ipv4.icmp_ignore_bogus_error_responses = 1)<br /><sub>(43)</sub> |Descrição: Um intruso pode realizar um ataque ICMP resultando em DoS |Executar `sysctl -w key=value` e definir para um valor compatível ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r enable-icmp-ignore-fake-error-responses' |
|Deve ser ativado o pedido de eco ICMP (pings) enviados para endereços de difusão/multicast. (net.ipv4.icmp_echo_ignore_broadcasts = 1)<br /><sub>(44)</sub> |Descrição: Um intruso pode realizar um ataque ICMP resultando em DoS |Executar `sysctl -w key=value` e definir para um valor compatível ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r enable-icmp-echo-ignore-broadcasts' |
|A exploração de pacotes marcianos (aqueles com endereços impossíveis) deve ser ativada para todas as interfaces. (net.ipv4.conf.all.log_martians = 1)<br /><sub>(45.1)</sub> |Descrição: Um intruso poderia enviar tráfego de endereços falsificados sem ser detetado |Executar `sysctl -w key=value` e definir para um valor compatível ou executar '/opt/microsoft/omsagent/plugin/omsremediato -r enable-log-martians' |
|A validação da fonte por caminho inverso deve ser ativada para todas as interfaces. (net.ipv4.conf.all.rp_filter = 1)<br /><sub>(46.1)</sub> |Descrição: O sistema aceitará o tráfego de endereços que não sejamíveis. |Executar `sysctl -w key=value` e definir para um valor compatível ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r enable-rp-filter' |
|A validação da fonte por caminho inverso deve ser ativada para todas as interfaces. (net.ipv4.conf.default.rp_filter = 1)<br /><sub>(46.2)</sub> |Descrição: O sistema aceitará o tráfego de endereços que não sejamíveis. |Executar `sysctl -w key=value` e definir para um valor compatível ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r enable-rp-filter' |
|As sincronizações de TCP devem ser ativadas. (net.ipv4.tcp_syncookies = 1)<br /><sub>(47)</sub> |Descrição: Um intruso poderia realizar um DoS sobre TCP |Executar `sysctl -w key=value` e definir para um valor compatível ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r enable-tcp-syncookies' |
|O sistema não deve funcionar como um farejador de rede.<br /><sub>(48)</sub> |Descrição: Um intruso pode usar interfaces promíscuas para cheirar o tráfego da rede |O modo promíscuo é ativado através de uma entrada 'promisc' em '/etc/rede/interfaces' ou '/etc/rc.local.' Verifique ambos os ficheiros e remova esta entrada. |
|Todas as interfaces sem fios devem ser desativadas.<br /><sub>(49)</sub> |Descrição: Um intruso pode criar um AP falso para intercetar transmissões. |Confirme que todas as interfaces sem fios são desativadas em '/etc/rede/interfaces' |
|O protocolo IPv6 deve ser ativado.<br /><sub>(50)</sub> |Descrição: Isto é necessário para a comunicação em redes modernas. |Abra /etc/sysctl.conf e confirme que 'net.ipv6.conf.all.disable_ipv6' e 'net.ipv6.conf.default.disable_ipv6' estão definidos para 0 |
|Certifique-se de que o DCCP está desativado<br /><sub>(54)</sub> |Descrição: Se o protocolo não for necessário, recomenda-se que os controladores não sejam instalados para reduzir a superfície de ataque potencial. |Editar ou criar um ficheiro no `/etc/modprobe.d/` diretório que termina em .conf e adicione `install dccp /bin/true` depois descarregar o módulo DCCP ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods' |
|Garantir que a SCTP está desativada<br /><sub>(55)</sub> |Descrição: Se o protocolo não for necessário, recomenda-se que os controladores não sejam instalados para reduzir a superfície de ataque potencial. |Editar ou criar um ficheiro no `/etc/modprobe.d/` diretório que termina em .conf e adicione `install sctp /bin/true` depois descarregar o módulo sctp ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods' |
|Desative o suporte para RDS.<br /><sub>(56)</sub> |Descrição: Um intruso pode usar uma vulnerabilidade em RDS para comprometer o sistema |Editar ou criar um ficheiro no `/etc/modprobe.d/` diretório que termina em .conf e adicione `install rds /bin/true` depois descarregar o módulo rds ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods' |
|Certifique-se de que o TIPC está desativado<br /><sub>(57)</sub> |Descrição: Se o protocolo não for necessário, recomenda-se que os controladores não sejam instalados para reduzir a superfície de ataque potencial. |Editar ou criar um ficheiro no `/etc/modprobe.d/` diretório que termina em .conf e adicione `install tipc /bin/true` depois descarregar o módulo tipc ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods' |
|Certifique-se de que o registo está configurado<br /><sub>(60)</sub> |Descrição: Uma grande quantidade de informações importantes relacionadas com a segurança são enviadas através `rsyslog` (por exemplo, tentativas de su bem sucedidas e falhadas, tentativas falhadas de login, tentativas de login de raiz, etc.). |Configure syslog, rsyslog ou syslog-ng, conforme apropriado |
|O pacote syslog, rsyslog ou syslog-ng deve ser instalado.<br /><sub>(61)</sub> |Descrição: Não serão registados problemas de fiabilidade e segurança, impedindo o diagnóstico adequado. |Instale o pacote de rsyslog ou corra '/opt/microsoft/omsagent/plugin/omsremediate -r install-r' |
|Certifique-se de que um serviço de registo está ativado<br /><sub>(62)</sub> |Descrição: É imperativo ter a capacidade de registar eventos num nó. |Ativar o pacote de rsyslog ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r enable-rsyslog' |
|As permissões de ficheiros para todos os ficheiros de registo de rsyslog devem ser definidas para 640 ou 600.<br /><sub>(63)</sub> |Descrição: Um intruso pode encobrir a atividade manipulando registos |Adicione a linha '$FileCreateMode 0640' ao ficheiro '/etc/rsyslog.conf' |
|Certifique-se de que os ficheiros de configuração do madeiro são restritos.<br /><sub>(63.1)</sub> |Descrição: É importante garantir que os ficheiros de registo existem e ter as permissões corretas para garantir que os dados sensíveis do syslog são arquivados e protegidos. |Defina os ficheiros de configuração do seu madeireiro para 0640 ou execute '/opt/microsoft/omsagent/plugin/omsremediate -r logger-config-file-permissões' |
|Todos os ficheiros de registo de rsyslog devem ser propriedade do grupo adm.<br /><sub>(64)</sub> |Descrição: Um intruso pode encobrir a atividade manipulando registos |Adicione a linha '$FileGroup adm' ao ficheiro '/etc/rsyslog.conf' |
|Todos os ficheiros de registo de rsyslog devem ser propriedade do utilizador syslog.<br /><sub>(65)</sub> |Descrição: Um intruso pode encobrir a atividade manipulando registos |Adicione a linha '$FileOwner syslog' ao ficheiro '/etc/rsyslog.conf' ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r syslog-owner |
|O Rsyslog não deve aceitar mensagens remotas.<br /><sub>(67)</sub> |Descrição: Um intruso pode injetar mensagens em syslog, causando um DoS ou uma distração de outras atividades |Remova as linhas '$ModLoad imudp' e '$ModLoad imtcp' do ficheiro '/etc/rsyslog.conf' |
|O serviço logrotate (syslog rotater) deve ser ativado.<br /><sub>(68)</sub> |Descrição: Os registos podem crescer sem limites e consumir todo o espaço do disco |Instale o pacote logrotate e confirme que a entrada de cron logrotate está ativa (chmod 755 /etc/cron.daily/logrotate; raiz de chown:raiz /etc/cron.daily/logrotate) |
|O serviço de rlogin deve ser desativado.<br /><sub>(69)</sub> |Descrição: Um intruso poderia ter acesso, contornando os requisitos de autenticação rigorosos |Retire o serviço de inetd. |
|Desative o inetd, a menos que seja necessário. (inetd)<br /><sub>(70.1)</sub> |Descrição: Um intruso poderia explorar uma vulnerabilidade num serviço inetd para ter acesso |Desinstalar o serviço inetd (apt-get remove inetd) |
|Desative o xinetd, a menos que seja necessário. (xinetd)<br /><sub>(70.2)</sub> |Descrição: Um intruso poderia explorar uma vulnerabilidade num serviço xinetd para ter acesso |Desinstalar o serviço inetd (apt-get remover xinetd) |
|Instale inetd apenas se apropriado e exigido pelo seu distro. Seguro de acordo com os padrões atuais de endurecimento. (se necessário)<br /><sub>(71.1)</sub> |Descrição: Um intruso poderia explorar uma vulnerabilidade num serviço inetd para ter acesso |Desinstalar o serviço inetd (apt-get remove inetd) |
|Instale xinetd apenas se apropriado e exigido pelo seu distro. Seguro de acordo com os padrões atuais de endurecimento. (se necessário)<br /><sub>(71.2)</sub> |Descrição: Um intruso poderia explorar uma vulnerabilidade num serviço xinetd para ter acesso |Desinstalar o serviço inetd (apt-get remover xinetd) |
|O serviço telnet deve ser desativado.<br /><sub>(72)</sub> |Descrição: Um intruso pode escutar ou sequestrar sessões de telnet não encriptadas |Remova ou comente a entrada de telnet no ficheiro '/etc/inetd.conf' |
|Todos os pacotes telneted devem ser desinstalados.<br /><sub>(73)</sub> |Descrição: Um intruso pode escutar ou sequestrar sessões de telnet não encriptadas |Desinstalar quaisquer pacotes telnetd |
|O serviço rcp/rsh deve ser desativado.<br /><sub>(74)</sub> |Descrição: Um intruso pode escutar ou sequestrar sessões não encriptadas |Remova ou comente a entrada do invólucro no ficheiro '/etc/inetd.conf' |
|O pacote do servidor rsh deve ser desinstalado.<br /><sub>(77)</sub> |Descrição: Um intruso pode escutar ou sequestrar sessões rsh não encriptadas |Desinstale o pacote do servidor rsh (apt-get remover rsh-servidor) |
|O serviço de ypbind deve ser desativado.<br /><sub>(78)</sub> |Descrição: Um intruso poderia obter informações sensíveis do serviço de ypbind |Desinstalar o pacote nis (apt-get remove nis) |
|O pacote de nis deve ser desinstalado.<br /><sub>(79)</sub> |Descrição: Um intruso poderia obter informações sensíveis do serviço NIS |Desinstalar o pacote nis (apt-get remove nis) |
|O serviço tftp deve ser desativado.<br /><sub>(80)</sub> |Descrição: Um intruso pode escutar ou sequestrar uma sessão não encriptada |Remova a entrada tftp do ficheiro '/etc/inetd.conf' |
|O pacote tftpd deve ser desinstalado.<br /><sub>(81)</sub> |Descrição: Um intruso pode escutar ou sequestrar uma sessão não encriptada |Desinstalar o pacote tftpd (apt-get remove tftpd) |
|O pacote readahead-fedora deve ser desinstalado.<br /><sub>(82)</sub> |Descrição: Sem exposição substancial, mas também sem benefícios substanciais |Desinstalar o pacote readahead-fedora (apt-get remover readahead-fedora) |
|O serviço bluetooth/hidrôdo deve ser desativado.<br /><sub>(84)</sub> |Descrição: Um intruso pode intercetar ou manipular comunicações sem fios. |Desinstalar o pacote bluetooth (apt-get remover bluetooth) |
|O serviço isdn deve ser desativado.<br /><sub>(86)</sub> |Descrição: Um intruso poderia usar um modem para obter acesso não autorizado |Desinstalar o pacote base de isdnutils (apt-get remove isdnutils-base) |
|O pacote base isdnutils deve ser desinstalado.<br /><sub>(87)</sub> |Descrição: Um intruso poderia usar um modem para obter acesso não autorizado |Desinstalar o pacote base de isdnutils (apt-get remove isdnutils-base) |
|O serviço kdump deve ser desativado.<br /><sub>(88)</sub> |Descrição: Um intruso poderia analisar uma falha anterior do sistema para obter informações confidenciais |Desinstalar o pacote de ferramentas kdump (apt-get remover ferramentas de kdump) |
|A rede Zeroconf deve ser desativada.<br /><sub>(89)</sub> |Descrição: Um intruso pode usar este abuso para obter informações sobre sistemas de rede, ou falsificar pedidos de DNS devido a falhas no seu modelo de confiança |Para RedHat, CentOS e Oráculo: Adicione `NOZEROCONF=yes or no` a /etc/sysconfig/rede. Para todos os outros distros: Remova quaisquer entradas 'ipv4ll' no ficheiro '/etc/rede/interfaces' ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-zeroconf' |
|O serviço de crond deve ser ativado.<br /><sub>(90)</sub> |Descrição: Cron é exigido por quase todos os sistemas para tarefas regulares de manutenção |Instale o pacote cron (apt-get install -y cron) e confirme que o ficheiro '/etc/init/cron.conf' contém a linha "iniciar-se no nível de execução [2345]" |
|As permissões de ficheiro para /etc/anacrontab devem ser definidas como raiz:raiz 600.<br /><sub>(91)</sub> |Descrição: Um intruso poderia manipular este ficheiro para evitar tarefas programadas ou executar tarefas maliciosas |Defina a propriedade e as permissões em /etc/anacrontab ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r fix-anacrontab-perms' |
|Certifique-se de que as permissões em /etc/cron.d estão configuradas.<br /><sub>(93)</sub> |Descrição: Conceder acesso por escrito a este diretório para utilizadores não privilegiados poderia fornecer-lhes os meios para obter privilégios elevados não autorizados. A concessão de acesso a este diretório poderia dar a um utilizador desprivilegiado a informação sobre como obter privilégios elevados ou contornar os controlos de auditoria. |Defina o proprietário e o grupo de /etc/chron.d para enraizar e permissões para 0700 ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r fix-cron-file-perms' |
|Certifique-se de que as permissões em /etc/cron.daily estão configuradas.<br /><sub>(94)</sub> |Descrição: Conceder acesso por escrito a este diretório para utilizadores não privilegiados poderia fornecer-lhes os meios para obter privilégios elevados não autorizados. A concessão de acesso a este diretório poderia dar a um utilizador desprivilegiado a informação sobre como obter privilégios elevados ou contornar os controlos de auditoria. |Defina o proprietário e grupo de /etc/chron.daily para raiz e permissões para 0700 ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r fix-cron-file-perms |
|Certifique-se de que as permissões em /etc/cron.hora são configuradas.<br /><sub>(95)</sub> |Descrição: Conceder acesso por escrito a este diretório para utilizadores não privilegiados poderia fornecer-lhes os meios para obter privilégios elevados não autorizados. A concessão de acesso a este diretório poderia dar a um utilizador desprivilegiado a informação sobre como obter privilégios elevados ou contornar os controlos de auditoria. |Defina o proprietário e grupo de /etc/chron.hourly para raiz e permissões para 0700 ou executar '/opt/microsoft/omsagent/plugin/omsremediato -r fix-cron-file-perms |
|Certifique-se de que as permissões em /etc/cron.mensalmente estão configuradas.<br /><sub>(96)</sub> |Descrição: Conceder acesso por escrito a este diretório para utilizadores não privilegiados poderia fornecer-lhes os meios para obter privilégios elevados não autorizados. A concessão de acesso a este diretório poderia dar a um utilizador desprivilegiado a informação sobre como obter privilégios elevados ou contornar os controlos de auditoria. |Defina o proprietário e grupo de /etc/chron.mensalmente para raiz e permissões para 0700 ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r fix-cron-file-perms |
|Certifique-se de que as permissões em /etc/cron.weekly estão configuradas.<br /><sub>(97)</sub> |Descrição: Conceder acesso por escrito a este diretório para utilizadores não privilegiados poderia fornecer-lhes os meios para obter privilégios elevados não autorizados. A concessão de acesso a este diretório poderia dar a um utilizador desprivilegiado a informação sobre como obter privilégios elevados ou contornar os controlos de auditoria. |Defina o proprietário e grupo de /etc/chron.weekly para raiz e permissões para 0700 ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r fix-cron-file-perms |
|Certifique-se de que a at/cron é restrita aos utilizadores autorizados<br /><sub>(98)</sub> |Descrição: Em muitos sistemas, apenas o administrador do sistema está autorizado a agendar `cron` postos de trabalho. Usar o `cron.allow` ficheiro para controlar quem pode gerir postos de trabalho aplica esta `cron` política. É mais fácil gerir uma lista de admissões do que uma lista de negação. Numa lista de negação, poderia potencialmente adicionar um ID de utilizador ao sistema e esquecer-se de adicioná-lo aos ficheiros de negação. |substituir /etc/cron.deny e /etc/at.deny com os `allow` respetivos ficheiros |
|Certifique-se de que o aviso de início remoto está configurado corretamente.<br /><sub>(111)</sub> |Descrição: As mensagens de aviso informam os utilizadores que estão a tentar iniciar sessão no sistema do seu estatuto legal em relação ao sistema e devem incluir o nome da organização que detém o sistema e quaisquer políticas de monitorização que estejam em vigor. Exibir informações de nível de SO e patch em banners de login também tem o efeito colateral de fornecer informações detalhadas do sistema aos atacantes que tentam direcionar as explorações específicas de um sistema. Os utilizadores autorizados podem facilmente obter esta informação executando o `uname -a` comando uma vez que tenham iniciado sessão. |Remova quaisquer instâncias de \m \r \s e \v do ficheiro /etc/issue.net |
|Certifique-se de que o aviso de início de sessão local está configurado corretamente.<br /><sub>(111.1)</sub> |Descrição: As mensagens de aviso informam os utilizadores que estão a tentar iniciar sessão no sistema do seu estatuto legal em relação ao sistema e devem incluir o nome da organização que detém o sistema e quaisquer políticas de monitorização que estejam em vigor. Exibir informações de nível de SO e patch em banners de login também tem o efeito colateral de fornecer informações detalhadas do sistema aos atacantes que tentam direcionar as explorações específicas de um sistema. Os utilizadores autorizados podem facilmente obter esta informação executando o `uname -a` comando uma vez que tenham iniciado sessão. |Remova quaisquer instâncias de \m \r \s e \v do ficheiro /etc/emissão |
|O serviço avahi-daemon deve ser desativado.<br /><sub>(114)</sub> |Descrição: Um intruso poderia usar uma vulnerabilidade no daemon avahi para ter acesso |Desative o serviço avahi-daemon ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-avahi-daemon' |
|O serviço de copos deve ser desativado.<br /><sub>(115)</sub> |Descrição: Um intruso poderia usar uma falha no serviço de copos para elevar privilégios |Desative o serviço de chávenas ou corra '/opt/microsoft/omsagent/plugin/omsremediato -r disable-cups' |
|O serviço isc-dhcpd deve ser desativado.<br /><sub>(116)</sub> |Descrição: Um intruso poderia usar o DHCPD para fornecer informações defeituosas aos clientes, interferindo no funcionamento normal. |Remova o pacote isc-dhcp-servidor (apt-get remover isc-dhcp-server) |
|O pacote isc-dhcp-servidor deve ser desinstalado.<br /><sub>(117)</sub> |Descrição: Um intruso poderia usar o DHCPD para fornecer informações defeituosas aos clientes, interferindo no funcionamento normal. |Remova o pacote isc-dhcp-servidor (apt-get remover isc-dhcp-server) |
|O pacote de envio deve ser desinstalado.<br /><sub>(120)</sub> |Descrição: Um intruso poderia usar este sistema para enviar e-mails com conteúdo malicioso a outros utilizadores |Desinstalar o pacote de envio (apt-get remover correio de envio) |
|O pacote postfix deve ser desinstalado.<br /><sub>(121)</sub> |Descrição: Um intruso poderia usar este sistema para enviar e-mails com conteúdo malicioso a outros utilizadores |Desinstalar o pacote de pós-fixação (apt-get remover postfix) ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r remove-postfix' |
|A audição da rede pós-fixa deve ser desativada conforme apropriado.<br /><sub>(122)</sub> |Descrição: Um intruso poderia usar este sistema para enviar e-mails com conteúdo malicioso a outros utilizadores |Adicione a linha 'inet_interfaces local' ao ficheiro '/etc/postfix/main.cf' |
|O serviço Ldap deve ser desativado.<br /><sub>(124)</sub> |Descrição: Um intruso poderia manipular o serviço LDAP neste anfitrião para distribuir dados falsos a clientes LDAP |Desinstalar o pacote esbofeteado (apt-get removedo) |
|O serviço rpcgssd deve ser desativado.<br /><sub>(126)</sub> |Descrição: Um intruso poderia usar uma falha em rpcgssd/nfs para ter acesso |Desative o serviço rpcgssd ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-rpcgssd' |
|O serviço rpcidmapd deve ser desativado.<br /><sub>(127)</sub> |Descrição: Um intruso poderia usar uma falha em idmapd/nfs para ter acesso |Desative o serviço rpcidmapd ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-rpcidmapd' |
|O serviço portmap deve ser desativado.<br /><sub>(129)</sub> |Descrição: Um intruso poderia usar uma falha no mapa portuário para ter acesso |Desative o serviço rpcbind ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r disable-rpcbind' |
|O serviço rpcsvcgssd deve ser desativado.<br /><sub>(130)</sub> |Descrição: Um intruso poderia usar uma falha no rpcsvcgsd para ter acesso |Remova a linha 'NEED_SVCGSSD = sim' do ficheiro '/etc/inetd.conf' |
|O serviço nomeado deve ser desativado.<br /><sub>(131)</sub> |Descrição: Um intruso poderia usar o serviço DNS para distribuir dados falsos aos clientes |Desinstalar o pacote bind9 (apt-get remover bind9) |
|O pacote de ligação deve ser desinstalado.<br /><sub>(132)</sub> |Descrição: Um intruso poderia usar o serviço DNS para distribuir dados falsos aos clientes |Desinstalar o pacote bind9 (apt-get remover bind9) |
|O serviço dovecot deve ser desativado.<br /><sub>(137)</sub> |Descrição: O sistema pode ser usado como um servidor IMAP/POP3 |Desinstalar o pacote dovecot-core (apt-get remover dovecot-core) |
|O pacote dovecot deve ser desinstalado.<br /><sub>(138)</sub> |Descrição: O sistema pode ser usado como um servidor IMAP/POP3 |Desinstalar o pacote dovecot-core (apt-get remover dovecot-core) |
|Certifique-se de que não `+` existem entradas antigas em /etc/passwd<br /><sub>(156.1)</sub> |Descrição: Um intruso poderia ter acesso usando o nome de utilizador '+' sem senha |Remova quaisquer entradas em /etc/passwd que comecem com '+:' |
|Certifique-se de que não `+` existem entradas antigas em /etc/sombra<br /><sub>(156.2)</sub> |Descrição: Um intruso poderia ter acesso usando o nome de utilizador '+' sem senha |Remova quaisquer entradas em /etc/sombra que comecem com '+:' |
|Certifique-se de que não `+` existem entradas antigas em /etc/grupo<br /><sub>(156.3)</sub> |Descrição: Um intruso poderia ter acesso usando o nome de utilizador '+' sem senha |Remova quaisquer entradas em /etc/grupo que comecem com '+:' |
|Certifique-se de que a expiração da palavra-passe é de 365 dias ou menos.<br /><sub>(157.1)</sub> |Descrição: A janela de oportunidade para um intruso aproveitar credenciais comprometidas ou comprometer credenciais com sucesso através de um ataque de força bruta on-line é limitada pela idade da palavra-passe. Portanto, reduzir a idade máxima de uma palavra-passe também reduz a janela de oportunidade de um intruso. |Definir o `PASS_MAX_DAYS` parâmetro para não mais de 365 ou executar `/etc/login.defs`  '/opt/microsoft/omsagent/plugin/omsremediate -r configurar-password-policy-max-days' |
|Certifique-se de que os dias de aviso de expiração da palavra-passe são 7 ou mais.<br /><sub>(157.2)</sub> |Descrição: Fornecer um aviso prévio de que uma palavra-passe expirará dá tempo aos utilizadores de pensarem numa senha segura. Os utilizadores apanhados desprevenidos podem escolher uma palavra-passe simples ou anotá-la onde possa ser descoberta. |Definir o `PASS_WARN_AGE` parâmetro para 7 dentro `/etc/login.defs`  ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r configurar-password-policy-warn-age' |
|Certifique-se de que a reutilização da palavra-passe é limitada.<br /><sub>(157.5)</sub> |Descrição: Forçar os utilizadores a não reutilizar as suas últimas 5 palavras-passe torna menos provável que um intruso consiga adivinhar a palavra-passe. |Certifique-se de que a opção 'lembre-se' é definida para pelo menos 5 em /etc/pam.d/common-password ou ambos /etc/pam.d/password_auth e /etc/pam.d/system_auth ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r configurar-password-history' |
|Certifique-se de que o algoritmo de hashing da palavra-passe é SHA-512<br /><sub>(157.11)</sub> |Descrição: O algoritmo SHA-512 fornece um hashing muito mais forte do que o MD5, proporcionando assim uma proteção adicional ao sistema, aumentando o nível de esforço para que um intruso determine com sucesso as palavras-passe. Nota: Estas alterações aplicam-se apenas às contas configuradas no sistema local. |Desloque o algoritmo de hashing da palavra-passe para sha512. Muitas distribuições fornecem ferramentas para atualizar a configuração DO PAM, consulte a sua documentação para obter detalhes. Se não for fornecida nenhuma ferramenta, edite o ficheiro de configuração apropriado `/etc/pam.d/` e adicione ou modifique as `pam_unix.so` linhas para incluir a opção sha512: ``` password sufficient pam_unix.so sha512 ``` |
|Certifique-se de que os dias mínimos entre as alterações de senha são 7 ou mais.<br /><sub>(157.12)</sub> |Descrição: Ao restringir a frequência das alterações de palavra-passe, um administrador pode impedir que os utilizadores mudem repetidamente a sua palavra-passe numa tentativa de contornar os controlos de reutilização de palavras-passe. |Desa um `PASS_MIN_DAYS` parâmetro a 7 em `/etc/login.defs` : `PASS_MIN_DAYS 7` . Modifique os parâmetros do utilizador para todos os utilizadores com uma palavra-passe definida para combinar: `chage --mindays 7`  ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r set-pass-min-days' |
|Certifique-se de que a última data de alteração da palavra-passe de todos os utilizadores está no passado<br /><sub>(157.14)</sub> |Descrição: Se um utilizador tiver uma data de alteração de senha gravada no futuro, poderá contornar qualquer validade definida da palavra-passe. |Certifique-se de que o bloqueio de senha inativo é de 30 dias ou menos Executar o seguinte comando para definir o período de inatividade da palavra-passe padrão para 30 dias: ``` # useradd -D -f 30 ``` Modificar os parâmetros do utilizador para todos os utilizadores com uma palavra-passe definida para combinar: ``` # chage --inactive 30  ``` |
|Garantir que as contas do sistema não são de login<br /><sub>(157.15)</sub> |Descrição: É importante garantir que as contas que não estão a ser utilizadas por utilizadores regulares sejam impedidas de serem utilizadas para fornecer uma concha interativa. Por predefinição, Ubuntu define o campo de palavra-passe para estas contas para uma cadeia inválida, mas também é recomendado que o campo de concha no ficheiro de palavra-passe seja definido para `/usr/sbin/nologin` . Isto evita que a conta seja potencialmente usada para executar quaisquer comandos. |Desagre a concha para quaisquer contas devolvidas pelo script de auditoria para `/sbin/nologin` |
|Certifique-se de que o grupo predefinido para a conta raiz é GID 0<br /><sub>(157.16)</sub> |Descrição: A utilização do GID 0 para a `_root_ ` conta ajuda a evitar que os `_root_` ficheiros pertencentes a si se tornem acidentalmente acessíveis a utilizadores não privilegiados. |Executar o seguinte comando para definir o grupo padrão do `root` utilizador para GID `0` : ``` # usermod -g 0 root ``` |
|Certifique-se de que a raiz é a única conta UID 0<br /><sub>(157.18)</sub> |Descrição: Este acesso deve limitar-se apenas à conta predefinida `root ` e apenas a partir da consola do sistema. O acesso administrativo deve ser através de uma conta desprivileçada utilizando um mecanismo aprovado. |Remova quaisquer utilizadores que não `root` sejam com UID `0` ou atribua-lhes um novo UID, se for caso disso. |
|Remover pacotes desnecessários<br /><sub>(158)</sub> |Descrição:  |Executar '/opt/microsoft/omsagent/plugin/omsremediate -r remover-paisagem-comum |
|Remover contas desnecessárias<br /><sub>(159)</sub> |Descrição: Para cumprimento |Remover as contas desnecessárias |
|Garantir que o serviço auditado está ativado<br /><sub>(162)</sub> |Descrição: A captura de eventos do sistema fornece aos administradores do sistema informações que lhes permitam determinar se o acesso não autorizado ao seu sistema está a ocorrer. |Instalar pacote de auditoria (sistemactl permitir auditado) |
|Serviço auditado de execução<br /><sub>(163)</sub> |Descrição: A captura de eventos do sistema fornece aos administradores do sistema informações que lhes permitam determinar se o acesso não autorizado ao seu sistema está a ocorrer. |Serviço auditado de execução (systemctl start auditado) |
|Certifique-se de que o SNMP Server não está ativado<br /><sub>(179)</sub> |Descrição: O servidor SNMP pode comunicar através do SNMP v1, que transmite dados de forma clara e não requer autenticação para executar comandos. A menos que seja absolutamente necessário, recomenda-se que o serviço SNMP não seja utilizado. Se for necessário que o SNMP seja configurado para desautorizado SNMP v1. |Executar um dos seguintes comandos para desativar: `snmpd` ``` # chkconfig snmpd off ``` ``` # systemctl disable snmpd `````` # update-rc.d snmpd disable ``` |
|Certifique-se de que o serviço de rsync não está ativado<br /><sub>(181)</sub> |Descrição: O `rsyncd` serviço apresenta um risco de segurança, uma vez que utiliza protocolos não encriptados para comunicação. |Executar um dos seguintes comandos para desativar: `rsyncd` `chkconfig rsyncd off` , ou executar `systemctl disable rsyncd` `update-rc.d rsyncd disable` '/opt/microsoft/omsagent/plugin/omsremediato -r disable-rsysnc' |
|Certifique-se de que o servidor NIS não está ativado<br /><sub>(182)</sub> |Descrição: O serviço NIS é inerentemente um sistema inseguro que tem sido vulnerável a ataques DOS, transbordo de tampão e tem uma fraca autenticação para consulta de mapas NIS. O NIS foi geralmente substituído por protocolos como o Lightweight Directory Access Protocol (LDAP). Recomenda-se que o serviço seja desativado e que outros serviços mais seguros sejam utilizados |Executar um dos seguintes comandos para desativar: `ypserv` ``` # chkconfig ypserv off ``` ``` # systemctl disable ypserv `````` # update-rc.d ypserv disable ``` |
|Certifique-se de que o cliente rsh não está instalado<br /><sub>(183)</sub> |Descrição: Estes clientes legados contêm numerosas exposições de segurança e foram substituídos pelo pacote SSH mais seguro. Mesmo que o servidor seja removido, o melhor é garantir que os clientes também são removidos para evitar que os utilizadores tentem inadvertidamente utilizar estes comandos e, portanto, expondo as suas credenciais. Note que remover a `rsh ` embalagem remove os clientes para , `rsh` e `rcp ` `rlogin` . |Desinstalar `rsh` utilizando o gestor de pacotes apropriado ou a instalação manual: ``` yum remove rsh ``` ``` apt-get remove rsh `````` zypper remove rsh ``` |
|Desativar SMB V1 com Samba<br /><sub>(185)</sub> |Descrição: SMB v1 tem vulnerabilidades bem conhecidas e graves e não encripta dados em trânsito. Se tiver de ser utilizado por razões comerciais dominantes, recomenda-se vivamente que sejam identificadas outras mitigações para compensar a utilização deste protocolo.  |Se o Samba não estiver em funcionamento, remova o pacote, caso contrário, deveria haver uma linha na secção [global] de /etc/samba/smb.conf: min protocol = SMB2 ou executar '/opt/microsoft/omsagent/plugin/omsremediate -r set-smb-min-version |

> [!NOTE]
> A disponibilidade de configurações específicas de configuração de convidados Azure Policy pode variar em Azure Government e outras nuvens nacionais.

## <a name="next-steps"></a>Passos seguintes

Artigos adicionais sobre Azure Policy e Configuração de Hóspedes:

- [Configuração do convidado de política Azure](../concepts/guest-configuration.md).
- [Visão geral da conformidade](../concepts/regulatory-compliance.md) regulamentar.
- Reveja outros exemplos nas [amostras da Azure Policy](./index.md).
- Veja [Compreender os efeitos do Policy](../concepts/effects.md).
- Saiba como [remediar recursos não conformes.](../how-to/remediate-resources.md)
