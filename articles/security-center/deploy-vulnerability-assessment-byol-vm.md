---
title: Avaliação de vulnerabilidade da BYOL VM no Centro de Segurança Azure
description: Implemente uma solução de avaliação de vulnerabilidades BYOL nas suas Máquinas Virtuais Azure para obter recomendações no Azure Security Center que podem ajudá-lo a proteger as suas máquinas virtuais.
services: security-center
documentationcenter: na
author: memildin
manager: rkarlin
ms.service: security-center
ms.devlang: na
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/22/2020
ms.author: memildin
ms.openlocfilehash: 598eb2295196ec767bc6abe7468ab31c73d208d0
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/09/2020
ms.locfileid: "91449480"
---
# <a name="deploy-a-bring-your-own-license-byol-vulnerability-assessment-solution"></a>Implemente uma solução de avaliação de vulnerabilidade de licença própria (BYOL)

Se tiver ativado **o Azure Defender para servidores,** poderá utilizar a ferramenta de avaliação de vulnerabilidade incorporada do Azure Security Center, tal como descrito no [scanner integrado de vulnerabilidade para máquinas virtuais.](built-in-vulnerability-assessment.md) Esta ferramenta está integrada no Azure Defender e não requer licenças externas - tudo é manuseado perfeitamente dentro do Security Center.

Em alternativa, poderá querer implementar a sua própria solução de avaliação de vulnerabilidades licenciada em privado a partir de [Qualys](https://www.qualys.com/lp/azure) ou [Rapid7](https://www.rapid7.com/products/insightvm/). Pode instalar uma destas soluções parceiras em vários VMs que pertencem à mesma subscrição.

## <a name="deploy-a-byol-solution-from-the-azure-portal"></a>Implementar uma solução BYOL a partir do portal Azure

As opções BYOL referem-se a soluções de avaliação de vulnerabilidade suportadas por terceiros. Atualmente, tanto a Qualys como a Rapid7 são fornecedores apoiados.

As soluções suportadas reportam dados de vulnerabilidade à plataforma de gestão do parceiro. Por sua vez, esta plataforma fornece dados de vulnerabilidade e monitorização de saúde de volta ao Centro de Segurança. Pode identificar VMs vulneráveis no painel do Centro de Segurança e mudar para a consola de gestão de parceiros diretamente do Centro de Segurança para obter relatórios e informações adicionais.

1. A partir do [portal Azure,](https://azure.microsoft.com/features/azure-portal/) **Abrir Centro de Segurança.**

1. A partir do menu do Centro de Segurança, abra a página **recomendações.**

1. Selecione a recomendação **Uma solução de avaliação de vulnerabilidade deve ser ativada nas suas máquinas virtuais**.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png" alt-text="Os agrupamentos das máquinas na solução de avaliação de vulnerabilidade **A devem ser ativados na página de recomendação das suas máquinas virtuais**" lightbox="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png":::

    Os seus VM aparecerão num ou mais dos seguintes grupos:

    * **Recursos saudáveis** – O Centro de Segurança detetou uma solução de avaliação de vulnerabilidades em execução nestes VMs.
    * **Recursos insalubres** – Uma extensão de scanner de vulnerabilidade pode ser implementada para estes VMs. 
    * **Recursos não aplicáveis** – estes VMs não podem ter uma extensão de scanner de vulnerabilidade implantada.

1. A partir da lista de máquinas não saudáveis, selecione as que recebem uma solução de avaliação de vulnerabilidade e selecione **Remediate**.

    >[!IMPORTANT]
    > Dependendo da sua configuração, só poderá ver um subconjunto desta lista. 
    >
    > - Se não tiver um scanner de vulnerabilidade de terceiros configurado, não lhe será oferecida a oportunidade de o implementar.
    > - Se os seus VMs selecionados não estiverem protegidos com o Azure Defender, a opção de scanner de vulnerabilidade integrada ASC não estará disponível.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-remediation-options.png" alt-text="Os agrupamentos das máquinas na solução de avaliação de vulnerabilidade **A devem ser ativados na página de recomendação das suas máquinas virtuais**":::

1. Se estiver a configurar uma nova configuração BYOL, selecione **Configurar um novo scanner de vulnerabilidade de terceiros**, selecione **Proceder**, e insira os detalhes do fornecedor da seguinte forma:

    1. Em **Grupo de recursos**, selecione **Utilizar existente**.
    1. Em **Localização**, selecione o local geográfico onde a solução se encontra.
    1. Para qualys, introduza a licença fornecida pela Qualys no campo **de código de licença.**
    1. Para Rapid7, faça o upload do **Ficheiro de Configuração Rapid7**.
    1. Na **caixa-chave Do Público,** insira a informação chave pública fornecida pelo parceiro.
    1. Para instalar automaticamente este agente de avaliação de vulnerabilidade em todos os VMs descobertos na subscrição desta solução, selecione **Auto implementar**.
    1. Selecione **OK**.

1. Se já criou a sua solução BYOL, selecione **Implementar o seu scanner de vulnerabilidade de terceiros configurado**e **Proceder**.

Após a instalação da solução de avaliação de vulnerabilidades nas máquinas-alvo, o Security Center realiza uma verificação para detetar e identificar vulnerabilidades no sistema e aplicação. A primeira análise poderá demorar algumas horas até ser concluída. Depois disso, corre de hora a hora.



## <a name="deploy-a-byol-solution-using-powershell-and-the-rest-api"></a>Implementar uma solução BYOL utilizando o PowerShell e a API REST

Para implementar programaticamente a sua própria solução de avaliação de vulnerabilidade licenciada privada a partir de [Qualys](https://www.qualys.com/lp/azure) ou [Rapid7,](https://www.rapid7.com/products/insightvm/)utilize o script fornecido [PowerShell > Vulnerability Solution](https://github.com/Azure/Azure-Security-Center/tree/master/Powershell%20scripts/Vulnerability%20Solution). Este script utiliza a API REST para criar uma nova solução de segurança na ASC. Você precisará de uma licença e uma chave fornecida pelo seu fornecedor de serviços (Qualys ou Rapid7).

> [!IMPORTANT] 
> Apenas uma solução pode ser criada por licença. Tentar criar outra solução utilizando o mesmo nome/licença/chave falhará.

### <a name="prerequisites"></a>Pré-requisitos

Módulos PowerShell necessários:

- Instalar módulo Az
- Instalar módulo Az.security

### <a name="run-the-script"></a>Executar o script

Para executar o script, você precisará das informações relevantes para os parâmetros abaixo.

| **Parâmetro** | **Necessário** | **Notas** |
|----|:----:|----|
|**SubscriptionId**|✔|A subscriçãoID da Subscrição Azure que contém os recursos que pretende analisar.|
|**ResourceGroupName**|✔|Nome do grupo de recursos. Utilize qualquer grupo de recursos existente, incluindo o padrão ("DefaultResourceGroup-xxx"). Como a solução não é um recurso Azure, não será listado no grupo de recursos, mas ainda assim está ligado a ele.|
|**vaSolutionName**|✔|O nome da nova solução.|
|**vaType**|✔|Qualys ou Rapid7.|
|**licençaSdesco**|✔|O vendedor forneceu o cordão de licença.|
|**publicKey**|✔|O vendedor forneceu a chave pública.|
|**autoUpdate**|-|Ativar (verdadeiro) ou desativar a implantação automática (falsa) para esta solução VA. Quando ativado, cada novo VM da subscrição tentará automaticamente ligar-se à solução.<br/>(Predefinição: Falso)|
||||

Sintaxe:

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId <Subscription Id> -resourceGroupName <RG Name>
-vaSolutionName <New solution name> -vaType <Qualys / Rapid7> -autoUpdate <true/false>
-licenceCode <License code from vendor> -publicKey <Public Key received from vendor>
```

Exemplo (este exemplo não inclui detalhes válidos da licença):

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId 'f4cx1b69-dtgb-4ch6-6y6f-ea2e95373d3b' -resourceGroupName 'DefaultResourceGroup-WEU' -vaSolutionName 'QualysVa001' -vaType 'Qualys' -autoUpdate 'false' `
-licenceCode 'eyJjaWQiOiJkZDg5OTYzXe4iMTMzLWM4NTAtODM5FD2mZWM1N2Q3ZGU5MjgiLCJgbTYuOiIyMmM5NDg3MS1lNTVkLTQ1OGItYjhlMC03OTRhMmM3YWM1ZGQiLCJwd3NVcmwiOiJodHRwczovL3FhZ3B1YmxpYy1wMDEuaW50LnF1YWx5cy5jb20vQ2xvdSKJY6VudC8iLCJwd3NQb3J0IjoiNDQzIn0=' `
-publicKey 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCOiOLXjOywMfLZIBGPZLwSocf1Q64GASLK9OHFEmanBl1nkJhZDrZ4YD5lM98fThYbAx1Rde2iYV1ze/wDlX4cIvFAyXuN7HbdkeIlBl6vWXEBZpUU17bOdJOUGolzEzNBhtxi/elEZLghq9Chmah82me/okGMIhJJsCiTtglVQIDAQAB'
```

## <a name="next-steps"></a>Passos seguintes

> [!div class="nextstepaction"]
> [Remediar as conclusões da sua solução de avaliação de vulnerabilidades](remediate-vulnerability-findings-vm.md)


O Security Center também oferece uma análise de vulnerabilidade para o seu:

- Bases de dados SQL - consulte [relatórios de avaliação de vulnerabilidades no painel de avaliação de vulnerabilidades](defender-for-sql-usage.md#explore-vulnerability-assessment-reports)
- Imagens do Registo de Contentores Azure - consulte [Use Azure Defender para registos de contentores para digitalizar as suas imagens para obter vulnerabilidades](defender-for-container-registries-usage.md)