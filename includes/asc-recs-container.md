---
author: memildin
ms.service: security-center
ms.topic: include
ms.date: 03/14/2021
ms.author: memildin
ms.custom: generated
ms.openlocfilehash: 4a03a36f098035db1a91b4516dedb6a303aa41d2
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 03/30/2021
ms.locfileid: "103466211"
---
Há **24** recomendações nesta categoria.

|Recomendação |Description |Gravidade |
|---|---|---|
|Azure Defender para registos de contentores deve ser ativado |Para construir cargas de trabalho seguras em contentores, certifique-se de que as imagens em que estão baseadas estão livres de vulnerabilidades conhecidas.<br>O Azure Defender para registos de contentores verifica o seu registo de vulnerabilidades de segurança em cada imagem de recipiente empurrado e expõe resultados detalhados por imagem.<br>Para melhorar a postura de segurança dos seus contentores e protegê-los de ataques, ative o Azure Defender para registos de contentores.<br><br>Importante: A reparação desta recomendação resultará em encargos para proteger os registos dos seus contentores. Se não tiver registos de contentores nesta subscrição, não serão incorridos quaisquer encargos.<br>Se criar algum registo de contentores nesta subscrição no futuro, eles serão automaticamente protegidos e os encargos começarão nessa altura.<br> <a href='https://docs.microsoft.com/azure/security-center/azure-container-registry-integration'>Saiba mais sobre o Azure Defender para registos de contentores.</a><br />(Política relacionada: [Azure Defender para registos de contentores deve ser ativado](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicyDefinitions%2fc25d9a16-bc35-4e15-a7e5-9db606bf9ed4)) |Alto |
|Azure Defender for Kubernetes deve ser ativado |O Azure Defender for Kubernetes fornece proteção contra ameaças em tempo real para os seus ambientes contentorizados e gera alertas para atividades suspeitas.<br>Pode utilizar estas informações para remediar rapidamente problemas de segurança e aumentar a segurança dos contentores.<br><br>Importante: Remediar esta recomendação resultará em encargos para proteger os seus clusters Kubernetes. Se não tiver nenhum cluster Kubernetes nesta subscrição, não serão incorridos quaisquer encargos.<br>Se criar algum cluster Kubernetes nesta subscrição no futuro, eles serão automaticamente protegidos e os custos começarão nessa altura.<br> <a href='https://docs.microsoft.com/azure/security-center/azure-kubernetes-service-integration'>Saiba mais sobre o Azure Defender para Kubernetes.</a><br />(Política relacionada: [Azure Defender for Kubernetes deve ser ativado](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicyDefinitions%2f523b5cd1-3e23-492f-a539-13118b6d1e3a)) |Alto |
|O Add-on de Política Azure para Kubernetes deve ser instalado e ativado nos seus clusters |O Azure Policy Add-on for Kubernetes estende <a target="_blank" href="https://github.com/open-policy-agent/gatekeeper">o Gatekeeper</a> v3, um webhook do controlador de admissão para <a target="_blank" href="https://www.openpolicyagent.org/">o Open Policy Agent</a> (OPA), para aplicar aplicações e salvaguardas em escala nos seus clusters de forma centralizada e consistente.<p>O Centro de Segurança requer o Add-on para auditar e impor capacidades de segurança e conformidade dentro dos seus clusters. <a target="_blank" href="https://docs.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes">Saiba mais.</a></p><p>Requer Kubernetes v1.14.0 ou mais tarde.</p><br />(Política relacionada: [O Azure Policy Add-on para o serviço Kubernetes (AKS) deve ser instalado e ativado nos seus clusters](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f0a15ec92-a229-4763-bb14-0ea34a568f8d)) |Alto |
|CpU do contentor e limites de memória devem ser aplicados |A aplicação dos limites de CPU e da memória previne ataques de exaustão de recursos (uma forma de ataque de negação de serviço).<p>Recomendamos a definição de limites para os recipientes, a fim de garantir que o tempo de funcionação impede que o recipiente utilize mais do que o limite de recursos configurado.</p><br />(Política relacionada: [Assegurar que os limites de CPU de contentores e de recursos de memória não excedam os limites especificados no cluster Kubernetes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fe345eecc-fa47-480f-9e88-67dcc122b164)) |Médio |
|As imagens dos contentores devem ser implantadas apenas a partir de registos fidedignos |As imagens que correm no seu cluster Kubernetes devem vir de registos de imagem de contentores conhecidos e monitorizados. Os registos fidedignos reduzem o risco de exposição do seu cluster limitando o potencial de introdução de vulnerabilidades desconhecidas, problemas de segurança e imagens maliciosas.<br />(Política relacionada: [Garantir apenas imagens de contentores permitidas no cluster Kubernetes)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2ffebd0533-8e55-448f-b837-bd0e06f16469) |Alto |
|Os registos de contentores devem ser encriptados com uma chave gerida pelo cliente (CMK) |Utilize as chaves geridas pelo cliente para gerir a encriptação no resto do conteúdo dos seus registos. Por padrão, os dados são encriptados em repouso com chaves geridas pelo serviço, mas as chaves geridas pelo cliente (CMK) são geralmente obrigadas a cumprir as normas de conformidade regulamentar. Os CMKs permitem que os dados sejam encriptados com uma chave Azure Key Vault criada e propriedade de si. Tem total controlo e responsabilidade pelo ciclo de vida chave, incluindo rotação e gestão. Saiba mais sobre a encriptação CMK em https://aka.ms/acr/CMK .<br />(Política relacionada: [Os registos de contentores devem ser encriptados com uma chave gerida pelo cliente (CMK)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580)) |Médio |
|Os registos de contentores não devem permitir o acesso ilimitado à rede |Os registos de contentores Azure por padrão aceitam ligações através da internet de anfitriões em qualquer rede. Para proteger os seus registos de ameaças potenciais, permita o acesso a partir de endereços IP públicos específicos ou intervalos de endereços. Se o seu registo não tiver uma regra IP/firewall ou uma rede virtual configurada, aparecerá nos recursos pouco saudáveis. Saiba mais sobre as regras da rede de registo de contentores aqui: https://aka.ms/acr/portal/public-network e aqui https://aka.ms/acr/vnet .<br />(Política conexa: [Os registos de contentores não devem permitir o acesso ilimitado à rede](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fd0793b48-0edc-4296-a390-4c75d1bdfd71)) |Médio |
|Os registos de contentores devem usar ligação privada |O Azure Private Link permite-lhe ligar a sua rede virtual aos serviços Azure sem um endereço IP público na fonte ou destino. A plataforma de ligação privada trata da conectividade entre o consumidor e os serviços através da rede de espinha dorsal Azure. Ao mapear pontos finais privados para os seus registos de contentores em vez de todo o serviço, também estará protegido contra riscos de fuga de dados. Saiba mais em: https://aka.ms/acr/private-link .<br />(Política relacionada: [Os registos de contentores devem utilizar ligações privadas)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fe8eef0a8-67cf-4eb4-9386-14b0e78733d4) |Médio |
|Contentor com escalada de privilégio deve ser evitado |Os contentores não devem funcionar com uma escalada de privilégio para enraizar no seu aglomerado de Kubernetes.<br>O atributo AllowPrivilegeEscalation controla se um processo pode ganhar mais privilégios do que o seu processo principal.<br />(Política relacionada: os [agrupamentos de Kubernetes não devem permitir a escalada do privilégio do contentor)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f1c6e92c9-99f0-4e55-9cf2-0c234dc48f99) |Médio |
|Os recipientes que partilham espaços sensíveis de nome de hospedeiro devem ser evitados |Para proteger contra a escalada de privilégios fora do recipiente, evite o acesso do casulo a espaços sensíveis de nomes de hospedeiros (ID do processo de anfitrião e anfitrião IPC) num cluster Kubernetes.<br />(Política relacionada: Os [recipientes de agrupamento kubernetes não devem partilhar o ID do processo de anfitrião ou o espaço de nome do IPC anfitrião](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8)) |Médio |
|Os contentores devem ouvir apenas as portas permitidas |Para reduzir a superfície de ataque do seu cluster Kubernetes, restringir o acesso ao cluster limitando o acesso dos contentores às portas configuradas.<br />(Política relacionada: [Assegurar que os contentores ouçam apenas em portas permitidas no cluster Kubernetes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f440b515e-a580-421e-abeb-b159a61ddcbc)) |Médio |
|O sistema de ficheiros de raiz imutável (apenas para leitura) deve ser aplicado para os contentores |Os recipientes devem funcionar com um sistema de ficheiros de raiz apenas lido no seu cluster Kubernetes. O sistema de ficheiros imutável protege os recipientes de alterações no tempo de funcionamento, com binários maliciosos a serem adicionados ao PATH.<br />(Política relacionada: Os [recipientes de agrupamento kubernetes devem funcionar com um sistema de ficheiros de raiz apenas lidos](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fdf49d893-a74c-421d-bc95-c663042e5b80)) |Médio |
|Os clusters Kubernetes só devem estar acessíveis em HTTPS |A utilização do HTTPS garante a autenticação e protege os dados em trânsito contra ataques de escutas de camadas de rede. Esta capacidade está atualmente disponível para o Serviço Kubernetes (AKS), e na pré-visualização para AKS Engine e Azure Arc habilitado a Kubernetes. Para mais informações, visite https://aka.ms/kubepolicydoc<br />(Política relacionada: [impor entrada HTTPS no cluster Kubernetes)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d) |Alto |
|O servidor API de Gestão de Serviços kubernetes deve ser configurado com acesso restrito |Para garantir que apenas aplicações de redes, máquinas ou sub-redes permitidas possam aceder ao seu cluster, restringir o acesso ao servidor API de Gestão de Serviços Kubernetes. Pode restringir o acesso definindo gamas de IP autorizadas ou configurando os seus servidores API como clusters privados, conforme explicado em <a target='_blank' href=https://docs.microsoft.com/azure/aks/private-clusters>https://docs.microsoft.com/azure/aks/private-clusters</a> .<br />(Política relacionada: [Os intervalos de IP autorizados devem ser definidos nos Serviços Kubernetes)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f0e246bcf-5f6f-4f87-bc6f-775d4712c7ea) |Alto |
|Os Serviços Kubernetes devem ser atualizados para uma versão não vulnerável de Kubernetes |Atualize o seu cluster de serviços Kubernetes para uma versão mais tarde da Kubernetes para proteger contra vulnerabilidades conhecidas na sua versão atual de Kubernetes. Vulnerabilidade <a target='_blank' href='https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9946'>CVE-2019-9946</a> foi corrigida nas versões Kubernetes 1.11.9+, 1.12.7+, 1.13.5+, e 1.14.0+<br />(Política relacionada: [os serviços kubernetes devem ser atualizados para uma versão kubernetes não vulnerável](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2ffb893a29-21bb-418c-a157-e99480ec364c)) |Alto |
|Capacidades linux menos privilegiadas devem ser aplicadas para contentores |Para reduzir a superfície de ataque do seu recipiente, restringir as capacidades do Linux e conceder privilégios específicos aos contentores sem conceder todos os privilégios do utilizador raiz. Recomendamos que abandone todas as capacidades e, em seguida, adicione as que são necessárias<br />(Política relacionada: os [recipientes de agrupamento kubernetes só devem utilizar capacidades permitidas)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fc26596ff-4d70-4e6a-9a30-c2506bd2f80c) |Médio |
|Sobrevaor ou desativação de contentores O perfil appArmor deve ser restringido |Os contentores que estão a funcionar no seu cluster Kubernetes devem limitar-se apenas aos perfis appArmor permitidos.<br>; AppArmor (Application Armor) é um módulo de segurança Linux que protege um sistema operativo e as suas aplicações contra ameaças à segurança. Para usá-lo, um administrador de sistema associa um perfil de segurança AppArmor a cada programa.<br />(Política relacionada: os [recipientes de agrupamento kubernetes só devem utilizar perfis appArmor permitidos](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f511f5417-5d12-434d-ab2e-816901e72a5e)) |Alto |
|Recipientes privilegiados devem ser evitados |Para evitar o acesso sem restrições ao hospedeiro, evite recipientes privilegiados sempre que possível.<p>Os recipientes privilegiados têm todas as capacidades de raiz de uma máquina hospedeira. Podem ser usados como pontos de entrada para ataques e para espalhar código malicioso ou malware para aplicações, anfitriões e redes comprometidas.</p><br />(Política relacionada: [Não permitir contentores privilegiados no cluster Kubernetes)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f95edb821-ddaf-4404-9732-666045e056b4) |Médio |
|Role-Based Controlo de Acesso deve ser utilizado nos serviços Kubernetes |Para fornecer filtragem granular sobre as ações que os utilizadores podem executar, utilize Role-Based Access Control (RBAC) para gerir permissões em Clusters de Serviços Kubernetes e configurar políticas de autorização relevantes. Para obter mais informações, consulte <a target='_blank' href='https://docs.microsoft.com/azure/aks/concepts-identity#role-based-access-controls-rbac'>o controlo de acesso baseado em funções da Azure.</a><br />(Política relacionada: [O Controlo de Acesso baseado em funções (RBAC) deve ser utilizado nos serviços kubernetes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fac4a19c2-fa67-49b4-8ae5-0b2e78c49457)) |Alto |
|Os recipientes de funcionamento como utilizador de raiz devem ser evitados |Os recipientes devem funcionar como utilizadores não-raiz no seu cluster Kubernetes. Executar um processo como o utilizador raiz dentro de um recipiente executa-o como raiz no hospedeiro. Em caso de compromisso, um intruso tem raiz no recipiente, e quaisquer configurações erradas tornam-se mais fáceis de explorar.<br />(Política relacionada: [as cápsulas e contentores de agrupamento kubernetes só devem funcionar com iDs de utilizador e grupo aprovados](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2ff06ddb64-5fa3-4b77-b166-acb36f7f6042)) |Alto |
|Os serviços devem ouvir apenas os portos permitidos |Para reduzir a superfície de ataque do seu cluster Kubernetes, restringir o acesso ao cluster limitando o acesso dos serviços às portas configuradas.<br />(Política relacionada: [Garantir que os serviços ouçam apenas em portas permitidas no cluster Kubernetes)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f233a2a17-77ca-4fb1-9b6b-69223d272a44) |Médio |
|A utilização da rede de acolhimento e das portas deve ser restringida |Restringir o acesso do pod à rede de anfitriões e à gama de portas de hospedeiro admissível num cluster Kubernetes. Os pods criados com o atributo hostNetwork ativado partilharão o espaço de rede do nó. Para evitar que o contentor comprometido cheire o tráfego da rede, recomendamos que não coloque as suas cápsulas na rede de anfitriões. Se precisar de expor uma porta de contentor na rede do nó e utilizar uma porta de nó de serviço Kubernetes não satisfaz as suas necessidades, outra possibilidade é especificar um HostPort para o recipiente na especificação do pod.<br />(Política relacionada: [as cápsulas de agrupamento Kubernetes só devem utilizar a rede de anfitriões aprovada e a gama portuária](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f82985f06-dc18-4a48-bc1c-b9f4f0098cfe)) |Médio |
|A utilização dos suportes de volume do Pod HostPath deve ser restringida a uma lista conhecida para restringir o acesso do nó a partir de contentores comprometidos |Recomendamos limitar os suportes de volume do HostPath no seu cluster Kubernetes aos caminhos de hospedeiro permitidos configurados. Em caso de compromisso, o acesso do nó do contentor aos contentores deve ser restringido<br />(Política relacionada: [os volumes de hospedeiros de agrupamento kubernetes só devem utilizar caminhos de hospedeiro permitidos](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f098fc59e-46c7-4d99-9b16-64990e543d75)) |Médio |
|As vulnerabilidades nas imagens do Registo de Contentores de Azure devem ser remediadas (alimentadas por Qualys) |A avaliação da vulnerabilidade da imagem do contentor verifica o seu registo de vulnerabilidades de segurança e expõe resultados detalhados para cada imagem. A resolução das vulnerabilidades pode melhorar consideravelmente a postura de segurança dos seus contentores e protegê-las de ataques.<br />(Política relacionada: [As vulnerabilidades nas imagens do registo de contentores do Azure devem ser remediadas)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f5f0f936f-2f01-4bf5-b6be-d423792fa562) |Alto |
|||
